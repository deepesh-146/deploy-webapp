{"version":3,"mappings":"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","names":["_angular_core__WEBPACK_IMPORTED_MODULE_3__","AddPromotionComponent","formBuilder","router","commonService","toastService","dialog","titleCasePipe","dialogRef","promotionService","JSON","parse","localStorage","getItem","control","discountPercentage","get","value","discountAmount","atLeastOneError","today","Date","promotionForm","group","schemaName","buyQuantity","_angular_forms__WEBPACK_IMPORTED_MODULE_4__","getQuantity","minBillAmt","type","validators","atLeastOneValidator","getAllProductsAvailableForPromotion","discountPercentageControl","discountAmountControl","valueChanges","subscribe","disabled","disable","enable","error","console","typeControl","clearValidators","setValidators","updateValueAndValidity","buyQtyControl","getQtyControl","toastMsg","title","content","controls","close","event","charCode","which","keyCode","data","userId","currentUser","id","page","size","productType","then","res","success","productsIdList","rows","err","status","transform","error_message","submitted","invalid","selectedProductIds","length","parseInt","parseFloat","addPromotion","notifyDataAdded","selectors","decls","vars","consts","template","ctx","_angular_core__WEBPACK_IMPORTED_MODULE_4__","AssignProductToPromotionComponent","productService","promotionId","payload","productArray","map","productId","assignProductsToPromotions","_angular_material_dialog__WEBPACK_IMPORTED_MODULE_6__","CounterDiscModalComponent","counterDetails","getCounterDiscountAmt","getCounterDiscountForm","saveOn","counterArr","i","counterDiscountControls","push","minimum","maximum","percent","minimumValidator","createCounterDetails","index","removeAt","log","arr","forEach","item","counterDiscountForm","updateCounterDiscount","prevMaximum","Infinity","currentMinimum","minimumError","CouponModalComponent","coupon_name","coupon_code","usage_limit","startDate","maxDiscountAmount","expiryDate","description","generateCoupon","patchValue","expose","toUpperCase","createCoupon","dateType","selectedDate","isNaN","getTime","setValue","minDate","setDate","getDate","_angular_core__WEBPACK_IMPORTED_MODULE_5__","ctx_r21","ctx_r25","ctx_r29","item_r27","CouponComponent","route","rxjs__WEBPACK_IMPORTED_MODULE_6__","getAllCoupons","rowAdded$","searchSubscription","searchSubject","pipe","isLoading","searchKey","searchCoupon","trim","couponList","isdeleted","isdeletedParty","selectedIdList","unArchiveMultiplePromotions","unArchivePromotions","deleteMultiplePromotions","archivePromotions","e","partyId","target","checked","promotionIdList","checkSingleArray","indexOf","splice","archivedPartyIds","unarchivedPartyIds","party","find","isDeleted","allArchived","every","allUnarchived","alert","checkSelectsingle","upiCheckedId","isChecked","allSelect","checkSelect","checkboxes","document","querySelectorAll","checkbox","inputElement","showUnarchiveButton","showDeleteButton","$event","Error","currentPageNo","toatlPages","requestBody","result","setTimeout","filter","toLowerCase","includes","next","excelFileUpload","files","pattern","test","name","formdata","FormData","set","uploadInput","getElementById","MouseEvent","view","window","bubbles","cancelable","dispatchEvent","pageIndex","pagesize","pageSize","partyPageSize","open","_coupon_modal_coupon_modal_component__WEBPACK_IMPORTED_MODULE_0__","width","height","disableClose","position","right","afterClosed","couponData","_edit_coupon_edit_coupon_component__WEBPACK_IMPORTED_MODULE_1__","isActive","newStatus","couponId","discount_percentage","start_date","end_date","max_discount_amount","updateCoupon","filterValue","selectedTypeFilter","isFilterVisible","viewQuery","EditCouponComponent","_angular_forms__WEBPACK_IMPORTED_MODULE_5__","getCouponData","_a","_b","_c","moment__WEBPACK_IMPORTED_MODULE_0__","format","maxDate","_angular_material_dialog__WEBPACK_IMPORTED_MODULE_7__","EditPromotionComponent","products","array","getPromotionById","promotionList","minumumBill","freeProductData","freeProduct","product","promotionData","updatePromotion","_angular_core__WEBPACK_IMPORTED_MODULE_7__","ctx_r22","ctx_r26","ctx_r30","item_r28","PromotionListComponent","rxjs__WEBPACK_IMPORTED_MODULE_8__","getAllPromotion","searchPromotion","dropdown","nativeElement","contains","pageData","_add_promotion_add_promotion_add_promotion_component__WEBPACK_IMPORTED_MODULE_0__","_counter_disc_modal_counter_disc_modal_component__WEBPACK_IMPORTED_MODULE_3__","_assign_product_to_promotion_assign_product_to_promotion_assign_product_to_promotion_component__WEBPACK_IMPORTED_MODULE_1__","_edit_promotion_edit_promotion_edit_promotion_component__WEBPACK_IMPORTED_MODULE_2__","promotionToggle","routes","path","component","_promotions_component__WEBPACK_IMPORTED_MODULE_0__","children","redirectTo","pathMatch","_components_promotion_list_promotion_list_component__WEBPACK_IMPORTED_MODULE_1__","_components_coupon_coupon_component__WEBPACK_IMPORTED_MODULE_2__","routerLinkActiveOptions","exact","PromotionsRoutingModule","_angular_router__WEBPACK_IMPORTED_MODULE_4__","imports","exports","PromotionsComponent","_angular_core__WEBPACK_IMPORTED_MODULE_0__","PromotionsModule","_angular_common__WEBPACK_IMPORTED_MODULE_12__","_promotions_routing_module__WEBPACK_IMPORTED_MODULE_0__","_angular_router__WEBPACK_IMPORTED_MODULE_13__","src_app_material_module__WEBPACK_IMPORTED_MODULE_1__","_angular_material_input__WEBPACK_IMPORTED_MODULE_14__","_angular_material_button__WEBPACK_IMPORTED_MODULE_15__","_angular_material_icon__WEBPACK_IMPORTED_MODULE_16__","_angular_material_core__WEBPACK_IMPORTED_MODULE_17__","_angular_material_form_field__WEBPACK_IMPORTED_MODULE_18__","_angular_material_datepicker__WEBPACK_IMPORTED_MODULE_19__","_angular_material_moment_adapter__WEBPACK_IMPORTED_MODULE_20__","_angular_forms__WEBPACK_IMPORTED_MODULE_21__","ngx_bootstrap_datepicker__WEBPACK_IMPORTED_MODULE_22__","declarations","_promotions_component__WEBPACK_IMPORTED_MODULE_2__","_components_promotion_list_promotion_list_component__WEBPACK_IMPORTED_MODULE_3__","_components_add_promotion_add_promotion_add_promotion_component__WEBPACK_IMPORTED_MODULE_4__","_components_edit_promotion_edit_promotion_edit_promotion_component__WEBPACK_IMPORTED_MODULE_5__","_components_assign_product_to_promotion_assign_product_to_promotion_assign_product_to_promotion_component__WEBPACK_IMPORTED_MODULE_6__","_components_counter_disc_modal_counter_disc_modal_component__WEBPACK_IMPORTED_MODULE_7__","_components_coupon_modal_coupon_modal_component__WEBPACK_IMPORTED_MODULE_8__","_components_coupon_coupon_component__WEBPACK_IMPORTED_MODULE_9__","_components_edit_coupon_edit_coupon_component__WEBPACK_IMPORTED_MODULE_10__"],"sources":["webpack:///src/app/pages/promotions/components/add-promotion/add-promotion/add-promotion.component.html","webpack:///src/app/pages/promotions/components/add-promotion/add-promotion/add-promotion.component.ts","webpack:///src/app/pages/promotions/components/assign-product-to-promotion/assign-product-to-promotion/assign-product-to-promotion.component.html","webpack:///src/app/pages/promotions/components/assign-product-to-promotion/assign-product-to-promotion/assign-product-to-promotion.component.ts","webpack:///src/app/pages/promotions/components/counter-disc-modal/counter-disc-modal.component.html","webpack:///src/app/pages/promotions/components/counter-disc-modal/counter-disc-modal.component.ts","webpack:///src/app/pages/promotions/components/coupon-modal/coupon-modal.component.html","webpack:///src/app/pages/promotions/components/coupon-modal/coupon-modal.component.ts","webpack:///src/app/pages/promotions/components/coupon/coupon.component.html","webpack:///src/app/pages/promotions/components/coupon/coupon.component.ts","webpack:///src/app/pages/promotions/components/edit-coupon/edit-coupon.component.html","webpack:///src/app/pages/promotions/components/edit-coupon/edit-coupon.component.ts","webpack:///src/app/pages/promotions/components/edit-promotion/edit-promotion/edit-promotion.component.html","webpack:///src/app/pages/promotions/components/edit-promotion/edit-promotion/edit-promotion.component.ts","webpack:///src/app/pages/promotions/components/promotion-list/promotion-list.component.html","webpack:///src/app/pages/promotions/components/promotion-list/promotion-list.component.ts","webpack:///src/app/pages/promotions/promotions-routing.module.ts","webpack:///src/app/pages/promotions/promotions.component.ts","webpack:///src/app/pages/promotions/promotions.component.html","webpack:///src/app/pages/promotions/promotions.module.ts"],"sourcesContent":["<div class=\"modal-header pt-0\">\r\n    <h1 style=\"color: #EB8B3F; font-weight: bolder;margin-left: 5px;\" class=\"modal-title mb-0\">Add Promotion</h1>\r\n\r\n    <div class=\"addProductButtons\">\r\n        <button type=\"button\" style=\"margin-right: 10px;\" class=\"btn btn-cancel\" (click)=\"cancel()\">Cancel</button>\r\n        <button type=\"button\" class=\"btn btn-save ms-2\" (click)=\"onSave()\">Save</button>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal-body\">\r\n    <form [formGroup]=\"promotionForm\">\r\n        <div class=\"row mb-3\">\r\n            <div style=\"font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n              <label class=\"form-label\">Schema Name<span class=\"error-asterisk\">*</span></label>\r\n              <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <input matInput placeholder=\"Schema Name\" maxlength=\"50\" formControlName=\"schemaName\" required>\r\n              </mat-form-field>\r\n              <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.schemaName.touched) && f.schemaName.errors?.required\">\r\n                Schema Name is required!\r\n              </mat-error>\r\n            </div>\r\n            <div style=\"font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n              <label class=\"form-label\">Type<span class=\"error-asterisk\">*</span></label>\r\n              <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <mat-select formControlName=\"type\" placeholder=\"Type\" required>\r\n                  <mat-option *ngFor=\"let item of types\" [value]=\"item\">\r\n                    {{ item }}\r\n                  </mat-option>\r\n                </mat-select>\r\n              </mat-form-field>\r\n              <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.type.touched) && f.type.errors?.required\">\r\n                Schema Type is required!\r\n              </mat-error>\r\n            </div>\r\n        </div>         \r\n\r\n        <div class=\"row mb-3\" *ngIf=\"f.type.value === 'DISCOUNT' \">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Percentage</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Discount Percentage\" maxlength=\"3\" formControlName=\"discountPercentage\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix>%</span>\r\n                </mat-form-field>\r\n                <mat-error *ngIf=\"f.discountPercentage.errors?.max\">\r\n                    Discount Percentage cannot exceed 100%.\r\n                </mat-error>\r\n            </div>\r\n            \r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Amount</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Discount Amount\" maxlength=\"10\" formControlName=\"discountAmount\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix> &nbsp;</span>\r\n                </mat-form-field>\r\n            </div>\r\n\r\n            <!-- Display error for both fields having errors and at least one being touched or submitted -->\r\n            <div *ngIf=\"promotionForm.hasError('atLeastOneError') && submitted\" class=\"text-danger\">\r\n                Please fill at least one of Discounted Amount or Discount Percentage.\r\n            </div>\r\n        </div>\r\n        \r\n        <div class=\"row mb-3\" *ngIf=\"f.type.value === 'FLAT'\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Minimum Bill Amount</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <span class=\"matSuffix\" matSuffix> &nbsp;</span>\r\n                    <input matInput placeholder=\"Discount Percentage\" maxlength=\"10\" formControlName=\"minBillAmt\" (keypress)=\"numberOnly($event)\">\r\n                </mat-form-field>\r\n            </div>\r\n            \r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Amount</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Discount Amount\" maxlength=\"10\" formControlName=\"discountAmount\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix> &nbsp;</span>\r\n                </mat-form-field>\r\n            </div>\r\n\r\n            <!-- Display error for both fields having errors and at least one being touched or submitted -->\r\n            <div *ngIf=\"promotionForm.hasError('atLeastOneError') && submitted\" class=\"text-danger\">\r\n                Please fill at least one of Discounted Amount or Discount Percentage.\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"row mb-3\" *ngIf=\"f.type.value !== 'FLAT'\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Buy Quantity<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Buy Quantity\" maxlength=\"5\" formControlName=\"buyQuantity\" (keypress)=\"numberOnly($event)\">\r\n                </mat-form-field>\r\n                <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.buyQuantity.touched) && f.buyQuantity.errors?.required\">\r\n                    Buy quantity is required!\r\n                </mat-error>\r\n            </div>\r\n\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Get Quantity<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <div style=\"display: inline-block;\">\r\n                        <input matInput placeholder=\"Get Quantity\" maxlength=\"5\" formControlName=\"getQuantity\" (keypress)=\"numberOnly($event)\">\r\n                    </div>\r\n                </mat-form-field>\r\n                <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.getQuantity.touched) && f.getQuantity.errors?.required\">\r\n                    Get quantity is required!\r\n                </mat-error>\r\n            </div>\r\n        </div>\r\n\r\n    </form>\r\n    <div class=\"row\" *ngIf=\"f.type.value === 'PRODUCT'\">\r\n        <div class=\"col-xs-12 col-sm-12 col-md-12 col-lg-12\">\r\n            <label class=\"form-label\">Products<span class=\"error-asterisk\">*</span></label>\r\n            <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <mat-select matNativeControl disableOptionCentering [(ngModel)]=\"selectedProductIds\" placeholder=\"Product\">\r\n                    <mat-option *ngFor=\"let product of productsIdList\" [value]=\"product.id\">\r\n                        {{ product.itemName }}\r\n                    </mat-option>\r\n                </mat-select>\r\n            </mat-form-field>\r\n        </div>          \r\n    </div>\r\n</div>","import { TitleCasePipe } from '@angular/common';\r\nimport { Component, Inject, OnInit } from '@angular/core';\r\nimport { FormArray, FormBuilder, Validators } from '@angular/forms';\r\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { Router } from '@angular/router';\r\nimport { Subject } from 'rxjs';\r\nimport { CommonService } from 'src/app/core/services/common.service';\r\nimport { AbstractControl, ValidationErrors, ValidatorFn } from '@angular/forms';\r\nimport { PromotionService } from 'src/app/core/services/promotion.service';\r\nimport { ToastNotificationService } from 'src/app/core/services/toast-notification.service';\r\n\r\n@Component({\r\n  selector: 'app-add-promotion',\r\n  templateUrl: './add-promotion.component.html',\r\n  styleUrls: ['./add-promotion.component.scss']\r\n})\r\nexport class AddPromotionComponent implements OnInit {\r\n\r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  public promotionForm: any;\r\n  public submitted: boolean = false;\r\n  public today: Date;\r\n  types: string[] = ['DISCOUNT', 'PRODUCT', 'FLAT'];  // ['DISCOUNT', 'PRODUCT', 'FLAT', 'COUPONS'];\r\n  productsIdList: any;\r\n  selectedProductIds: string[] = [];\r\n\r\n  constructor(private formBuilder: FormBuilder,\r\n    public router: Router, private commonService: CommonService,\r\n    private toastService: ToastNotificationService, public dialog: MatDialog,\r\n    private titleCasePipe: TitleCasePipe,\r\n    // @Inject(MAT_DIALOG_DATA) public data: any,\r\n    public dialogRef: MatDialogRef<AddPromotionComponent>,\r\n    private promotionService: PromotionService\r\n  ) {\r\n    this.today = new Date();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    try {\r\n      this.promotionForm = this.formBuilder.group({\r\n          schemaName: [null],\r\n          buyQuantity: [null, Validators.required],\r\n          getQuantity: [null, Validators.required],\r\n          discountPercentage: [null, [Validators.min(0), Validators.max(100)]],\r\n          discountAmount: [null],\r\n          minBillAmt: [null],\r\n          type: ['DISCOUNT', Validators.required], // Default value 'DISCOUNT'\r\n      },\r\n      {\r\n          validators: [\r\n              this.atLeastOneValidator\r\n          ], // Apply the custom validator\r\n      }\r\n      );\r\n      this.getAllProductsAvailableForPromotion()\r\n      const discountPercentageControl = this.promotionForm.get('discountPercentage');\r\n      const discountAmountControl = this.promotionForm.get('discountAmount');\r\n\r\n      // Subscribe to valueChanges of discountPercentage control\r\n      discountPercentageControl?.valueChanges.subscribe(value => {\r\n          try {\r\n              if (value && !discountAmountControl?.disabled) {\r\n                  discountAmountControl?.disable();\r\n              } else if (!value && discountAmountControl?.disabled) {\r\n                  discountAmountControl?.enable();\r\n              }\r\n          } catch (error) {\r\n              console.error('Error in discountPercentageControl subscription:', error);\r\n          }\r\n      });\r\n\r\n      // Subscribe to valueChanges of discountAmount control\r\n      discountAmountControl?.valueChanges.subscribe(value => {\r\n          try {\r\n              if (value && !discountPercentageControl?.disabled) {\r\n                  discountPercentageControl?.disable();\r\n              } else if (!value && discountPercentageControl?.disabled) {\r\n                  discountPercentageControl?.enable();\r\n              }\r\n          } catch (error) {\r\n              console.error('Error in discountAmountControl subscription:', error);\r\n          }\r\n      });\r\n\r\n      // If type is PRODUCT then discounted fields are get hidden... so below is code for that condition\r\n      // When the type changes, adjust validators accordingly\r\n      const typeControl = this.promotionForm.get('type');\r\n\r\n      typeControl?.valueChanges.subscribe((type: string) => {\r\n        // Dynamically adjust validators based on the selected type\r\n        if (type === 'PRODUCT') {\r\n          discountPercentageControl?.clearValidators();\r\n          discountAmountControl?.clearValidators();\r\n        } else {\r\n          discountPercentageControl?.setValidators([Validators.min(0), Validators.max(100)]);\r\n          discountAmountControl?.setValidators(null);\r\n        }\r\n\r\n        // Update and validate the controls\r\n        discountPercentageControl?.updateValueAndValidity();\r\n        discountAmountControl?.updateValueAndValidity();\r\n\r\n        // Update the form level validators as well\r\n        this.promotionForm.updateValueAndValidity();\r\n      });\r\n\r\n      // If type is FLAT then buy and get qty are get hidden... so below is code for that condition\r\n      // When the type changes, adjust validators accordingly\r\n      const buyQtyControl = this.promotionForm.get('buyQuantity');\r\n      const getQtyControl = this.promotionForm.get('getQuantity');\r\n      typeControl?.valueChanges.subscribe((type: string) => {\r\n        // Dynamically adjust validators based on the selected type\r\n        if (type === 'FLAT') {\r\n          buyQtyControl?.clearValidators();\r\n          getQtyControl?.clearValidators();\r\n        } else {\r\n          getQtyControl?.setValidators(Validators.required);\r\n          buyQtyControl?.setValidators(Validators.required);\r\n        }\r\n\r\n        // Update and validate the controls\r\n        getQtyControl?.updateValueAndValidity();\r\n        buyQtyControl?.updateValueAndValidity();\r\n\r\n        // Update the form level validators as well\r\n        this.promotionForm.updateValueAndValidity();\r\n      });\r\n    } catch (error) {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: error\r\n        })\r\n    }\r\n  }\r\n\r\n  atLeastOneValidator: ValidatorFn = (control: AbstractControl): ValidationErrors | null => {\r\n    const discountPercentage = control.get('discountPercentage').value;\r\n    const discountAmount = control.get('discountAmount').value;\r\n  \r\n    // Check if the type is \"DISCOUNT\" and at least one of the fields is empty\r\n    if (control.get('type').value === 'DISCOUNT' && (!discountPercentage && !discountAmount)) {\r\n      return { atLeastOneError: true };\r\n    }\r\n  \r\n    return null;\r\n  };   \r\n  \r\n  get f() {\r\n    return this.promotionForm.controls;\r\n  }\r\n\r\n  cancel() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  numberOnly(event): boolean {\r\n    const charCode = (event.which) ? event.which : event.keyCode;\r\n    if (charCode > 31 && (charCode < 48 || charCode > 57)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  numberDecimalOnly(event): boolean {\r\n    var charCode = (event.which) ? event.which : event.keyCode;\r\n    if (charCode != 46 && charCode > 31\r\n      && (charCode < 48 || charCode > 57)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  getAllProductsAvailableForPromotion() {\r\n    this.promotionService.getAllProductsAvailableForPromotion({\r\n      data: {}, \r\n      userId: this.currentUser.id, \r\n      page: 1, \r\n      size: 1000, \r\n      productType: 'GOODS'\r\n    }).then((res) => {\r\n      if(res.success) {\r\n        this.productsIdList = res.data.rows;\r\n      }\r\n    },(err) => {\r\n        if (err.error.status === 404) {\r\n            this.toastService.toastMsg({\r\n              title: 'Error',\r\n              content: 'Data Not Found!!!'\r\n            })\r\n        } else {\r\n          this.toastService.toastMsg({\r\n            title: 'Error',\r\n            content: this.titleCasePipe.transform(err.error.error_message)\r\n          })\r\n        }\r\n      });\r\n  }\r\n\r\n  onSave() {\r\n    this.submitted = true;\r\n    if (this.promotionForm.invalid) {\r\n      this.toastService.toastMsg({\r\n        title: \"Error\",\r\n        content: \"Fill All Required Fields.\",\r\n      });\r\n      return false;\r\n    } else if(this.selectedProductIds.length < 1 && this.promotionForm.value.type === 'PRODUCT') {\r\n      this.toastService.toastMsg({\r\n        title: 'Error',\r\n        content: 'please select atleast one product'\r\n      })\r\n    } else {\r\n      const data = {\r\n        \"promotionData\": {\r\n          \"type\": this.promotionForm.value.type,\r\n          \"schemaName\": this.promotionForm.value.schemaName,\r\n          \"buyQuantity\": this.promotionForm.value.type !== 'FLAT' ? parseInt(this.promotionForm.value.buyQuantity, 10) : null,\r\n          \"getQuantity\": this.promotionForm.value.type !== 'FLAT' ? parseInt(this.promotionForm.value.getQuantity, 10) : null,\r\n          \"discountPercentage\": this.promotionForm.value.type === 'PRODUCT' ? 100.00 : parseFloat(this.promotionForm.value.discountPercentage),\r\n          \"discountAmount\": this.promotionForm.value.type === 'PRODUCT' ? null : parseFloat(this.promotionForm.value.discountAmount),\r\n          \"isActive\": true,\r\n          \"freeProductId\": this.promotionForm.value.type === 'PRODUCT' ? this.selectedProductIds : null,\r\n          // If DiscountAmount is there user cannot sent the discountPercentage value or vise versa\r\n          \"minumumBill\": this.promotionForm.value.minBillAmt ? this.promotionForm.value.minBillAmt : null,\r\n        }\r\n      }\r\n      this.promotionService.addPromotion(data, this.currentUser.id).then( res => {\r\n        if(res.success) {\r\n          this.dialogRef.close();\r\n          this.commonService.notifyDataAdded()\r\n          this.toastService.toastMsg({\r\n            title: \"Success\",\r\n            content: \"Promotion Addedd Successfully!!!\",\r\n          });\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n}\r\n","<div class=\"modal-header pt-0\">\r\n    <h1 style=\"color: #EB8B3F; font-weight: bolder;margin-left: 5px;\" class=\"modal-title mb-0\">Assign Products</h1>\r\n    <button type=\"button\" class=\"btn-close\" aria-label=\"Close\" (click)=\"cancel()\"></button>\r\n</div>\r\n\r\n<div class=\"modal-body\">\r\n    <div class=\"row\">\r\n        <div class=\"col-xs-12 col-sm-12 col-md-12 col-lg-12\">\r\n            <label class=\"form-label\">Products</label>\r\n            <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <mat-select matNativeControl disableOptionCentering [(ngModel)]=\"selectedProductIds\" multiple placeholder=\"Product\">\r\n                    <mat-option *ngFor=\"let product of productsIdList\" [value]=\"product.id\">\r\n                        {{ product.itemName }}\r\n                    </mat-option>\r\n                </mat-select>\r\n            </mat-form-field>\r\n        </div>          \r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal-footer\">\r\n    <div class=\"addProductButtons\">\r\n        <button type=\"button\" class=\"btn btn-save ms-2\" (click)=\"onSave()\">Assign</button>\r\n    </div>\r\n</div>","import { TitleCasePipe } from '@angular/common';\r\nimport { Component, Inject, OnInit } from '@angular/core';\r\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { Router } from '@angular/router';\r\nimport { CommonService } from 'src/app/core/services/common.service';\r\nimport { ProductService } from 'src/app/core/services/product.service';\r\nimport { PromotionService } from 'src/app/core/services/promotion.service';\r\nimport { ToastNotificationService } from 'src/app/core/services/toast-notification.service';\r\n\r\n@Component({\r\n  selector: 'app-assign-product-to-promotion',\r\n  templateUrl: './assign-product-to-promotion.component.html',\r\n  styleUrls: ['./assign-product-to-promotion.component.scss']\r\n})\r\nexport class AssignProductToPromotionComponent implements OnInit {\r\n\r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  formBuilder: any;\r\n  promotionForm: any;\r\n  promotionId: any;\r\n  productsIdList: any;\r\n  selectedProductIds: string[] = [];\r\n\r\n  constructor(public router: Router, private commonService: CommonService,\r\n    private toastService: ToastNotificationService, public dialog: MatDialog,\r\n    private titleCasePipe: TitleCasePipe,\r\n    @Inject(MAT_DIALOG_DATA) public data: any,\r\n    public dialogRef: MatDialogRef<AssignProductToPromotionComponent>,\r\n    private promotionService: PromotionService,\r\n    private productService: ProductService,) { \r\n      this.promotionId = this.data.promotionId;\r\n    }\r\n\r\n  ngOnInit(): void {\r\n    this.getAllProductsAvailableForPromotion()\r\n  }\r\n\r\n  getAllProductsAvailableForPromotion() {\r\n    this.promotionService.getAllProductsAvailableForPromotion({\r\n      data: {}, \r\n      userId: this.currentUser.id, \r\n      page: 1, \r\n      size: 1000, \r\n      productType: 'GOODS'\r\n  }).then((res) => {\r\n      if(res.success) {\r\n        this.productsIdList = res.data.rows;\r\n      }\r\n    },(err) => {\r\n        if (err.error.status === 404) {\r\n            this.toastService.toastMsg({\r\n              title: 'Error',\r\n              content: 'Data Not Found!!!'\r\n            })\r\n        } else {\r\n          this.toastService.toastMsg({\r\n            title: 'Error',\r\n            content: this.titleCasePipe.transform(err.error.error_message)\r\n          })\r\n        }\r\n      });\r\n  }\r\n\r\n  onSave() {\r\n    const payload = {\r\n      promotionId: this.promotionId,\r\n      productArray: this.selectedProductIds.map(productId => ({ productId }))\r\n    };\r\n    if(this.selectedProductIds.length > 0) {\r\n      this.promotionService.assignProductsToPromotions(payload, this.currentUser.id)\r\n      .then((res) => {\r\n        if(res.success) {\r\n          this.toastService.toastMsg({\r\n            title: 'Success',\r\n            content: \"Selected products assigned Successfully!!!\"\r\n          })\r\n          this.dialogRef.close();\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        if(error.status == 409) {\r\n          this.toastService.toastMsg({\r\n            title: 'Error',\r\n            content: \"The product shall be already assigned to another promotion\"\r\n          })\r\n        } else {\r\n          this.toastService.toastMsg({\r\n            title: 'Error',\r\n            content: this.titleCasePipe.transform(error.error.error_message)\r\n          })\r\n        }\r\n      });\r\n    } else {\r\n      this.toastService.toastMsg({\r\n        title: 'Error',\r\n        content: 'please select atleast one product'\r\n      })\r\n    }\r\n  }\r\n\r\n  cancel() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n}\r\n","<div class=\"modal-header pt-0\">\r\n    <h1 style=\"color: #EB8B3F; font-weight: bolder;margin-left: 5px;\" class=\"modal-title mb-0\">Add Counter Discount</h1>\r\n\r\n    <div class=\"addProductButtons\">\r\n        <button type=\"button\" style=\"margin-right: 10px;\" class=\"btn btn-cancel\" (click)=\"cancel()\">Cancel</button>\r\n        <button *ngIf=\"saveOn\" type=\"button\" class=\"btn btn-save ms-2\" (click)=\"onSave()\">Save</button>\r\n        <button *ngIf=\"!saveOn\" type=\"button\" class=\"btn btn-save ms-2\" (click)=\"updateCounterDiscount()\">Update</button>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal-body\">\r\n    <form [formGroup]=\"promotionForm\">\r\n        <div class=\"row mb-3\">\r\n              <!-- <div class=\"row\">\r\n                <div class=\"card-body p-0 m-2 col-12\">\r\n                    <div id=\"tableExample\">\r\n                        <div class=\"table-responsive\">\r\n                            <table class=\"table table-bordered table-striped fs--1 mb-0\">\r\n                                <thead class=\"text-900 text-center inner-model-table-heading\">\r\n                                    <tr>\r\n                                        <th class=\"p-2\">minimum</th>\r\n                                        <th class=\"p-2\">maximum</th>\r\n                                        <th class=\"p-2\">percent</th>\r\n                                    </tr>\r\n                                </thead>\r\n                                <tbody class=\"list text-center\" id=\"table-customers-body\">\r\n                                    <ng-container formArrayName=\"counterDetails\" *ngFor=\"let group of counterDiscountControls.controls; let i = index\">\r\n                                        <tr [formGroupName]=\"i\">\r\n\r\n                                            <td>\r\n                                                <input matInput type=\"text\" formControlName=\"minimum\" />\r\n                                            </td>\r\n                                            <td>\r\n                                                <input matInput type=\"text\"\r\n                                                    ngxOnlyNumbers formControlName=\"maximum\" />\r\n                                            </td>\r\n                                            <td>\r\n                                                <input matInput type=\"text\" class=\"\" formControlName=\"percent\"\r\n                                                    (keyup.enter)=\"addCounterDetails()\" />\r\n                                            </td> \r\n                                        </tr>\r\n                                    </ng-container>\r\n                                </tbody>\r\n\r\n                            </table>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>  -->\r\n            <table class=\"mb-0\">\r\n                <thead class=\"text-900 text-center\">\r\n                    <tr>\r\n                        <th class=\"p-2\">Minimum</th>\r\n                        <th class=\"p-2\">Maximum</th>\r\n                        <th class=\"p-2\">Percent</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody class=\"list text-center\">\r\n                    <ng-container formArrayName=\"counterDetails\" *ngFor=\"let group of counterDiscountControls.controls; let i = index\">\r\n                        <tr [formGroupName]=\"i\">\r\n                            <td>\r\n                                <div class=\"row-container\">\r\n                                    <mat-form-field class=\"example-full-width input-padding\" appearance=\"outline\">\r\n                                        <input matInput matNativeControl formControlName=\"minimum\" placeholder=\"Minimum\" [min]=\"setMinLength(i)\"/>\r\n                                    </mat-form-field>\r\n                                    <mat-error *ngIf=\"group.get('minimum').hasError('minimumError')\" class=\"text-danger\">\r\n                                            Minimum must be greater than the previous Maximum.\r\n                                    </mat-error>\r\n                                </div>\r\n                            </td>\r\n                            <td>\r\n                                <mat-form-field class=\"example-full-width input-padding\" appearance=\"outline\">\r\n                                    <input matInput matNativeControl formControlName=\"maximum\" placeholder=\"Maximum\"/>\r\n                                </mat-form-field>\r\n                            </td>\r\n                            <td>\r\n                                <mat-form-field class=\"example-full-width input-padding\" appearance=\"outline\">\r\n                                    <input matInput matNativeControl formControlName=\"percent\" placeholder=\"Percentage\"/>\r\n                                    <span class=\"matSuffix\" matSuffix>%</span>\r\n                                </mat-form-field>\r\n                            </td>\r\n                            <td>\r\n                                <button mat-icon-button (click)=\"deleteCounterDetails(i)\">\r\n                                    <mat-icon>close</mat-icon>\r\n                                  </button>\r\n                            </td>\r\n                        </tr>\r\n                    </ng-container>\r\n                </tbody>\r\n            </table>\r\n\r\n            <div class=\"row d-flex justify-content-between\">\r\n                <div class=\"col-sm-12 col-md-9 col-lg-9\"></div>\r\n                <div class=\"col-sm-12 col-md-3 col-lg-3 text-nowrap mb-3\">\r\n                    <p class=\"text-nowrap\" (click)=\"addCounterDetails()\" style=\"color: #FC7643;\">\r\n                        <span id=\"boot-icon\" class=\"bi bi-plus-lg newrow\"></span>\r\n                        Add New Row\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </form>\r\n</div>","import { TitleCasePipe } from '@angular/common';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormArray, FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { Router } from '@angular/router';\r\nimport { CommonService } from 'src/app/core/services/common.service';\r\nimport { PromotionService } from 'src/app/core/services/promotion.service';\r\nimport { ToastNotificationService } from 'src/app/core/services/toast-notification.service';\r\n\r\n@Component({\r\n  selector: 'app-counter-disc-modal',\r\n  templateUrl: './counter-disc-modal.component.html',\r\n  styleUrls: ['./counter-disc-modal.component.scss']\r\n})\r\nexport class CounterDiscModalComponent implements OnInit {\r\n  \r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  public promotionForm: any;\r\n  public submitted: boolean = false;\r\n  public today: Date;\r\n  types: string[] = ['DISCOUNT', 'PRODUCT', 'FLAT'];  // ['DISCOUNT', 'PRODUCT', 'FLAT', 'COUPONS'];\r\n  productsIdList: any;\r\n  selectedProductIds: string[] = [];\r\n  saveOn: boolean = true;\r\n\r\n  constructor(private formBuilder: FormBuilder,\r\n    public router: Router, private commonService: CommonService,\r\n    private toastService: ToastNotificationService, public dialog: MatDialog,\r\n    private titleCasePipe: TitleCasePipe,\r\n    // @Inject(MAT_DIALOG_DATA) public data: any,\r\n    public dialogRef: MatDialogRef<CounterDiscModalComponent>,\r\n    private promotionService: PromotionService\r\n  ) {\r\n    this.today = new Date();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    try {\r\n      this.promotionForm = this.formBuilder.group({\r\n          counterDetails: new FormArray([]),\r\n        },\r\n      );\r\n      this.getCounterDiscountAmt()\r\n    } catch {\r\n\r\n    }\r\n  }\r\n\r\n  get f() {\r\n    return this.promotionForm.controls;\r\n  }\r\n\r\n  get counterDiscountControls() {\r\n    return this.promotionForm.get('counterDetails') as FormArray;\r\n  }\r\n  \r\n  getCounterDiscountAmt(){\r\n    this.promotionService.getCounterDiscountForm({}, this.currentUser.id).then(res => {\r\n      if(res.success) {\r\n        if(res.data.length > 0) {\r\n          this.saveOn = false\r\n        } else {\r\n          this.saveOn = true\r\n        }\r\n        let counterArr = res.data;\r\n        if (counterArr.length) {\r\n          for (let i = 0; i < counterArr.length; i++) {\r\n            this.counterDiscountControls.push(\r\n              new FormGroup({\r\n                minimum: new FormControl(counterArr[i].minimum),\r\n                maximum: new FormControl(counterArr[i].maximum),\r\n                percent: new FormControl(counterArr[i].percent),\r\n                id: new FormControl(counterArr[i].id),\r\n              })\r\n            )\r\n          }\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  cancel() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  createCounterDetails(): FormGroup {\r\n    return new FormGroup({\r\n      minimum: new FormControl(\"\", [Validators.required, this.minimumValidator(0)]),\r\n      maximum: new FormControl(\"\"),\r\n      percent: new FormControl(\"\",),\r\n    });\r\n  }\r\n  \r\n  addCounterDetails(): void {\r\n    const data = this.promotionForm.get('counterDetails') as FormArray;\r\n    data.push(this.createCounterDetails());\r\n  }\r\n  \r\n  deleteCounterDetails(index: number): void {\r\n    const data = this.promotionForm.get('counterDetails') as FormArray;\r\n    data.removeAt(index)\r\n  }\r\n\r\n  onSave() {\r\n    this.submitted = true;\r\n    console.log(this.promotionForm)\r\n    if (this.promotionForm.invalid) {\r\n      this.toastService.toastMsg({\r\n        title: \"Error\",\r\n        content: \"Fill All Required Fields.\",\r\n      });\r\n      return false;\r\n    } else {\r\n      const arr = this.promotionForm.value.counterDetails\r\n      arr.forEach(item => item.userId = this.currentUser.id)\r\n      this.promotionService.counterDiscountForm({data : arr }).then( res => {\r\n        if(res.success) {\r\n          this.dialogRef.close();\r\n          this.commonService.notifyDataAdded()\r\n          this.toastService.toastMsg({\r\n            title: \"Success\",\r\n            content: \"Discount Addedd Successfully!!!\",\r\n          });\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  updateCounterDiscount(){\r\n    this.submitted = true;\r\n    console.log(this.promotionForm)\r\n    if (this.promotionForm.invalid) {\r\n      this.toastService.toastMsg({\r\n        title: \"Error\",\r\n        content: \"Fill All Required Fields.\",\r\n      });\r\n      return false;\r\n    } else {\r\n      const arr = this.promotionForm.value.counterDetails\r\n      arr.forEach(item => item.userId = this.currentUser.id)\r\n      this.promotionService.updateCounterDiscount({data : arr }, this.currentUser.id).then( res => {\r\n        if(res.success) {\r\n          this.dialogRef.close();\r\n          this.commonService.notifyDataAdded()\r\n          this.toastService.toastMsg({\r\n            title: \"Success\",\r\n            content: \"Promotion Addedd Successfully!!!\",\r\n          });\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  setMinLength(index: number): number {\r\n    const controls = this.counterDiscountControls.controls;\r\n  \r\n    // Check if there is a previous row\r\n    if (index > 0) {\r\n      const prevMaximum = controls[index - 1].get('maximum').value;\r\n      return prevMaximum;\r\n    } else {\r\n      // If it's the first row, return an initial value (e.g., 0)\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  minimumValidator(index: number) {\r\n    return (control) => {\r\n      const controls = this.counterDiscountControls.controls;\r\n      const prevMaximum = index > 0 ? controls[index - 1].get('maximum').value : -Infinity;\r\n      const currentMinimum = control.value;\r\n      if (currentMinimum <= prevMaximum) {\r\n        return { minimumError: true };\r\n      } else {\r\n        return null;\r\n      }\r\n    };\r\n  }\r\n  \r\n}\r\n","<div class=\"modal-header pt-0\">\r\n    <h1 style=\"color: #EB8B3F; font-weight: bolder;margin-left: 5px;\" class=\"modal-title mb-0\">Create Coupons</h1>\r\n\r\n    <div class=\"addProductButtons\">\r\n        <button type=\"button\" style=\"margin-right: 10px;\" class=\"btn btn-cancel\" (click)=\"cancel()\">Cancel</button>\r\n        <button type=\"button\" class=\"btn btn-save ms-2\" (click)=\"onSave()\">Save</button>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal-body\">\r\n    <form [formGroup]=\"promotionForm\">\r\n        <div class=\"row mb-3\">\r\n            <div style=\"font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n              <label class=\"form-label\">Coupon Name<span class=\"error-asterisk\">*</span></label>\r\n              <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <input matInput placeholder=\"Coupon Name\" maxlength=\"50\" formControlName=\"coupon_name\" required>\r\n              </mat-form-field>\r\n              <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.coupon_name.touched) && f.coupon_name.errors?.required\">\r\n                Coupon name is required!\r\n              </mat-error>\r\n            </div>\r\n            <div style=\"font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n              <label class=\"form-label\">Coupon Code<span class=\"error-asterisk\">*</span></label>\r\n              <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <input matInput style=\"text-transform : uppercase\" placeholder=\"Coupon Code\" maxlength=\"8\" minlength=\"3\" formControlName=\"coupon_code\" required>\r\n                <span matSuffix>\r\n                  <a style=\"cursor: pointer; color: 110152;\" (click)=\"generateCoupon()\" matTooltip=\"Generate Coupon\">\r\n                    <i class=\"fas fa-sync-alt\"></i>\r\n                  </a>\r\n                </span>\r\n              </mat-form-field>\r\n              <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.coupon_code.touched) && f.coupon_code.errors?.required\">\r\n                Coupon Code is required!\r\n              </mat-error>\r\n              <mat-error class=\"text-danger\" *ngIf=\"f.coupon_code.errors?.minlength\">\r\n                Coupon Code must be greater than 3 characters!\r\n              </mat-error>\r\n            </div>\r\n        </div>         \r\n\r\n        <div class=\"row mb-3\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Percentage</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Discount Percentage\" maxlength=\"3\" formControlName=\"discountPercentage\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix>%</span>\r\n                </mat-form-field>\r\n                <mat-error *ngIf=\"f.discountPercentage.errors?.max\">\r\n                    Discount Percentage cannot exceed 100%.\r\n                </mat-error>\r\n            </div>\r\n            \r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Upto</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Max Discount Amount\" maxlength=\"10\" formControlName=\"maxDiscountAmount\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix>&nbsp;</span>\r\n                </mat-form-field>\r\n            </div>\r\n\r\n        </div>\r\n        \r\n        <div class=\"row mb-3\">\r\n          <label class=\"form-label\">Description <span class=\"error-asterisk\">*</span></label>\r\n          <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n            <textarea matInput autocomplete=\"off\" formControlName=\"description\" rows=\"3\" maxlength=\"150\" placeholder=\"Description\">\r\n            </textarea>\r\n          </mat-form-field>\r\n        </div>\r\n        \r\n        <div class=\"row mb-3\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Start date<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field style=\"font-size: 12px\" class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput bsDatepicker required placeholder=\"Start Date\" class=\"text-uppercase\" formControlName=\"startDate\"\r\n                      bsDatepicker [bsConfig]=\"{\r\n                        containerClass: 'theme-dark-blue',\r\n                        dateInputFormat: 'DD MMM YYYY',\r\n                        showWeekNumbers: false\r\n                      }\" [ngClass]=\"{\r\n                        'is-invalid':\r\n                          f.startDate.invalid && f.startDate.touched && submitted\r\n                      }\" (click)=\"openDatepicker('startDate')\" />\r\n                    <span>\r\n                      <mat-icon class=\"iconcalender\">date_range</mat-icon>\r\n                    </span>\r\n                  </mat-form-field>\r\n                  <mat-error class=\"text-danger\" *ngIf=\"\r\n                      (submitted || f.startDate.touched) &&\r\n                      f.startDate.errors?.required\r\n                    \">\r\n                    Start Date is Required!\r\n                  </mat-error>\r\n            </div>\r\n            \r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Expiry Date<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field style=\"font-size: 12px\" class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput bsDatepicker placeholder=\"Expiry Date\" [minDate]=\"calculateMinDate()\"\r\n                      class=\"text-uppercase\" formControlName=\"expiryDate\" bsDatepicker required [bsConfig]=\"{\r\n                        containerClass: 'theme-dark-blue',\r\n                        dateInputFormat: 'DD MMM YYYY',\r\n                        showWeekNumbers: false,\r\n                        showOnFocus: true\r\n                      }\" (click)=\"openDatepicker('expiryDate')\" />\r\n                    <span>\r\n                      <mat-icon class=\"iconcalender\">date_range</mat-icon>\r\n                    </span>\r\n                  </mat-form-field>\r\n                  <mat-error class=\"text-danger\" *ngIf=\"\r\n                      (submitted || f.expiryDate.touched) &&\r\n                      f.expiryDate.errors?.required\r\n                    \">\r\n                    Expiry Date is Required!\r\n                  </mat-error>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"row mb-3\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Usage Limit</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Usage Limit\" maxlength=\"8\" formControlName=\"usage_limit\" (keypress)=\"numberOnly($event)\">\r\n                </mat-form-field>\r\n                <!-- <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.usage_limit.touched) && f.usage_limit.errors?.required\">\r\n                    Usage Limit is required!\r\n                </mat-error> -->\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </form>    \r\n</div>","import { TitleCasePipe } from '@angular/common';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormArray, FormBuilder, FormControl, FormGroup, Validators } from '@angular/forms';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { Router } from '@angular/router';\r\nimport { CommonService } from 'src/app/core/services/common.service';\r\nimport { PromotionService } from 'src/app/core/services/promotion.service';\r\nimport { ToastNotificationService } from 'src/app/core/services/toast-notification.service';\r\n\r\n@Component({\r\n  selector: 'app-coupon-modal',\r\n  templateUrl: './coupon-modal.component.html',\r\n  styleUrls: ['./coupon-modal.component.scss']\r\n})\r\nexport class CouponModalComponent implements OnInit {\r\n\r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  public promotionForm: any;\r\n  public submitted: boolean = false;\r\n  public today: Date;\r\n  types: string[] = ['DISCOUNT', 'PRODUCT', 'FLAT'];  // ['DISCOUNT', 'PRODUCT', 'FLAT', 'COUPONS'];\r\n  productsIdList: any;\r\n  selectedProductIds: string[] = [];\r\n\r\n  constructor(private formBuilder: FormBuilder,\r\n    public router: Router, private commonService: CommonService,\r\n    private toastService: ToastNotificationService, public dialog: MatDialog,\r\n    private titleCasePipe: TitleCasePipe,\r\n    // @Inject(MAT_DIALOG_DATA) public data: any,\r\n    public dialogRef: MatDialogRef<CouponModalComponent>,\r\n    private promotionService: PromotionService\r\n  ) {\r\n    this.today = new Date();\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    try {\r\n      this.promotionForm = this.formBuilder.group({\r\n        coupon_name: [null, Validators.required],\r\n        coupon_code: [null, Validators.required],\r\n        usage_limit: [null],\r\n        startDate: [null, Validators.required],\r\n        discountPercentage: [null, [Validators.min(0), Validators.max(100)]],\r\n        maxDiscountAmount: [null],\r\n        expiryDate: [null, Validators.required],\r\n        description: [null],\r\n      })\r\n    } catch (error) {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: error\r\n        })\r\n    }\r\n  }\r\n  \r\n  get f() {\r\n    return this.promotionForm.controls;\r\n  }\r\n\r\n  cancel() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  generateCoupon() {\r\n    this.promotionService.generateCoupon({}, this.currentUser.id).then((res) => {\r\n      if (res.success) {\r\n        this.promotionForm.patchValue({\r\n          coupon_code: res.data\r\n        })\r\n      }\r\n    }, (err) => {\r\n      if (err.error.expose) {\r\n        this.toastService.toastMsg({\r\n          title: \"Error\",\r\n          content: this.titleCasePipe.transform(err.error.error_message),\r\n        });\r\n      }\r\n      else {\r\n        this.toastService.toastMsg({\r\n          title: \"Error\",\r\n          content: \"Something Went Wrong.\",\r\n        });\r\n      }\r\n    })\r\n  }\r\n\r\n  numberOnly(event): boolean {\r\n    const charCode = (event.which) ? event.which : event.keyCode;\r\n    if (charCode > 31 && (charCode < 48 || charCode > 57)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  numberDecimalOnly(event): boolean {\r\n    var charCode = (event.which) ? event.which : event.keyCode;\r\n    if (charCode != 46 && charCode > 31\r\n      && (charCode < 48 || charCode > 57)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  onSave() {\r\n    this.submitted = true;\r\n    console.log(this.promotionForm)\r\n    if (this.promotionForm.invalid) {\r\n      this.toastService.toastMsg({\r\n        title: \"Error\",\r\n        content: \"Fill All Required Fields.\",\r\n      });\r\n      return false;\r\n    } else {\r\n      const data = {\r\n        \"couponData\": {\r\n            \"coupon_code\": this.promotionForm.value.coupon_code.toUpperCase(),\r\n            \"coupon_name\": this.promotionForm.value.coupon_name,\r\n            \"discount_percentage\": this.promotionForm.value.discountPercentage,\r\n            \"start_date\": this.promotionForm.value.startDate,\r\n            \"end_date\": this.promotionForm.value.expiryDate,\r\n            \"is_valid\": true,\r\n            \"usage_limit\": this.promotionForm.value.usage_limit,\r\n            \"max_discount_amount\": this.promotionForm.value.maxDiscountAmount,\r\n            \"description\": this.promotionForm.value.description\r\n        }\r\n      }\r\n      this.promotionService.createCoupon(data, this.currentUser.id).then( res => {\r\n        if(res.success) {\r\n          this.dialogRef.close();\r\n          this.commonService.notifyDataAdded()\r\n          this.toastService.toastMsg({\r\n            title: \"Success\",\r\n            content: \"Coupon Addedd Successfully!!!\",\r\n          });\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  openDatepicker(dateType){\r\n    // Check if the current value of taskdate is an \"Invalid Date\"\r\n    if(dateType === 'startDate') {\r\n      const selectedDate = this.promotionForm.get('startDate').value;\r\n      if (isNaN(selectedDate.getTime())) {\r\n        // Set a default date or any valid date here\r\n        this.promotionForm.get('startDate').setValue(new Date());\r\n      }\r\n    } else if(dateType === 'expiryDate') {\r\n      const selectedDate = this.promotionForm.get('expiryDate').value;\r\n      if (isNaN(selectedDate.getTime())) {\r\n        // Set a default date or any valid date here\r\n        this.promotionForm.get('expiryDate').setValue(new Date());\r\n      }\r\n    }\r\n  }\r\n\r\n  calculateMinDate() {\r\n    const expiryDate = this.promotionForm.get('startDate').value;\r\n    // Assuming expiryDate is a valid Date object\r\n    if (expiryDate) {\r\n        const minDate = new Date(expiryDate);\r\n        minDate.setDate(minDate.getDate() + 1); // Setting the minimum date as one day after joining date\r\n        return minDate;\r\n    }\r\n    return null; // or you can set a default minDate if joiningDate is not set\r\n  }\r\n}\r\n","<div *ngIf=\"isLoading\" class=\"loader-container\">\r\n    <div class=\"loader\">\r\n        <div class=\"spinner-border\" role=\"status\">\r\n            <span class=\"visually-hidden\">Loading...</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"container-fluid bg-white p-0\">\r\n    <div class=\"row headerButtons mb-3\" id=\"showoptionHide\">\r\n        <div class=\"flex-item searchBar\">\r\n            <input type=\"search\" id=\"searchInput\" class=\"search-form-control pe-5 my-2\" placeholder=\"Search...\"\r\n                (input)=\"onSearchInputChange($event.target.value)\" />\r\n        </div>\r\n        <div class=\"navOption-btns flex-item formButtons mx-0\">\r\n            <button id=\"saleButtonPrint1\" class=\"btn text-nowrap my-2\" type=\"button\" (click)=\"couponsModal()\">\r\n                <i class=\"fas fa-plus me-2\"> </i>Coupons&nbsp;&nbsp;&nbsp;\r\n            </button>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"table-container overflow-auto\">\r\n        <div class=\"table-div\" style=\"overflow-x: auto\">\r\n            <table class=\"table table-responsive\">\r\n                <thead>\r\n                    <tr>\r\n                      <th class=\"text-nowrap\" style=\"vertical-align: middle;width:80px;height:50px;display:flex;align-items: center;\">\r\n\r\n                            <input type=\"checkbox\" class=\"form-check-input\" (change)=\"onChekMultiple($event)\"\r\n                                [value]=\"-1\" [checked]=\"\r\n                                promotionIdList.length === couponList.length\r\n                              \" [(ngModel)]=\"allSelect\" />\r\n                            <div class=\"d-flex align-items-center\">\r\n                                <span *ngIf=\"showDeleteButton\">\r\n                                    <button *ngIf=\"checkSingleArray.length > 0 || isChecked\" class=\"btn\"\r\n                                        data-bs-toggle=\"modal\" data-bs-target=\"#errorArchiveSelect-modal\"\r\n                                        style=\"padding-top: 15px\">\r\n                                        <span *ngIf=\"checkSingleArray.length > 0 || isChecked\"\r\n                                            class=\"material-icons icon-color iconFontSize\" data-bs-toggle=\"tooltip\"\r\n                                            style=\"color: #fc7643\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"\r\n                                            title=\"Archive\" (click)=\"\r\n                                            upiCheckedId.length > 0\r\n                                              ? getUPIcheckId(upiCheckedId)\r\n                                              : getSingleCheckedId(checkSingleArray)\r\n                                          \">archive\r\n                                        </span>\r\n                                    </button>\r\n                                </span>\r\n                                <span *ngIf=\"showUnarchiveButton\">\r\n                                    <button *ngIf=\"checkSingleArray.length > 0 || isChecked\" class=\"btn\"\r\n                                        data-bs-toggle=\"modal\" data-bs-target=\"#errorUnarchiveSelect-modal\"\r\n                                        style=\"padding-top: 15px\">\r\n                                        <span *ngIf=\"checkSingleArray.length > 0 || isChecked\"\r\n                                            class=\"material-icons icon-color iconFontSize\" data-bs-toggle=\"tooltip\"\r\n                                            style=\"color: #fc7643\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"\r\n                                            title=\"Unarchive\" (click)=\"\r\n                                            upiCheckedId.length > 0\r\n                                              ? getUPIcheckId(upiCheckedId)\r\n                                              : getSingleCheckedId(checkSingleArray)\r\n                                          \">unarchive\r\n                                        </span>\r\n                                    </button>\r\n                                </span>\r\n                            </div>\r\n                      </th>\r\n                      <th class=\"text-nowrap\">Coupon Name</th>\r\n                      <th class=\"text-nowrap\">Coupon Code</th>\r\n                      <th class=\"text-nowrap\">Discount Percentage</th>\r\n                      <th class=\"text-nowrap\" style=\"text-align: right;\">Maximum Discount Amount</th>\r\n                      <th class=\"text-nowrap\">Start Date</th>\r\n                      <th class=\"text-nowrap\">Expiry Date</th>\r\n                      <th class=\"text-nowrap\">Upto Users</th>\r\n                      <th class=\"text-nowrap\"></th>\r\n                      <th class=\"text-nowrap\"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <ng-container *ngFor=\"let item of couponList; let i = index\">\r\n                        <tr style=\"color: #676398 !important\"\r\n                            [ngStyle]=\"{ 'background-color': item.isDeleted ? '#c7c2de' : i % 2 === 0 ? '#ffffff' : '#f2f2f2' }\"\r\n                            *ngIf=\"selectedTypeFilter === null || item.type === selectedTypeFilter\">\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle;width:80px;\">\r\n                                <input class=\"form-check-input\" type=\"checkbox\" [ngClass]=\"{\r\n                                    'custom-checkbox': !item.isDeleted,\r\n                                    'custom-checkbox deleted': item.isDeleted\r\n                                    }\" [checked]=\"promotionIdList.includes(item.id)\" (change)=\"onChekedsingleCheck($event, item.id)\"\r\n                                    [value]=\"item.id\" />\r\n                            </td>\r\n                            <td class=\"long-name\" style=\"vertical-align: middle\">\r\n                                {{ item?.coupon_name }}\r\n                            </td><td class=\"long-name\" style=\"vertical-align: middle\">\r\n                                {{ item?.coupon_code }}\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle;\">\r\n                                {{ item?.discount_percentage ? (item?.discount_percentage | number:'1.2-2') + ' %' : 0 }}\r\n                            </td>\r\n                            <td class=\"text-nowrap \" style=\"vertical-align: middle ;text-align : right;\">\r\n                                &nbsp;  {{ item?.max_discount_amount ? item.max_discount_amount : '0' }}\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle\">\r\n                                {{ item?.end_date | date:\"dd MMM YYYY\" | uppercase }}\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle\">\r\n                                {{ item?.end_date | date:\"dd MMM YYYY\" | uppercase }}\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle\">\r\n                                {{ item?.usage_limit }}\r\n                            </td>\r\n                            <td class=\"text-nowrap varticalAlign\">\r\n                                <div class=\"\">\r\n                                    <button class=\"toggle-button\" (click)=\"isActive(item, item.is_valid)\"\r\n                                        [ngClass]=\"{'active': item.is_valid, 'inactive': !item.is_valid}\">\r\n                                        <div class=\"toggle-slider\"></div>\r\n                                    </button>\r\n                                </div>\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"text-align: center; vertical-align: middle\">\r\n                                <div>\r\n                                    <!-- <button class=\"btn\">\r\n                                        <span class=\"bi bi-eye icon-color iconFontSize ps-2\" (click)=\"viewConsignmentModal(item.id)\" data-bs-toggle=\"tooltip\"\r\n                                        data-bs-placement=\"top\" title=\"View\"></span>\r\n                                    </button> -->\r\n\r\n                                    <button class=\"btn\">\r\n                                        <span class=\"bi-pencil-square icon-color iconFontSize ps-2\"\r\n                                            (click)=\"editCouponModal(item)\" data-bs-toggle=\"tooltip\"\r\n                                            data-bs-placement=\"top\" title=\"Edit\"></span>\r\n                                    </button>\r\n\r\n                                    <button class=\"btn mt-2\" data-bs-toggle=\"modal\" data-bs-target=\"#errorDelete-modal\" [disabled]=\"this.promotionIdList.length != 0\">\r\n                                        <span class=\"material-icons icon-color iconFontSize\" data-bs-toggle=\"tooltip\"\r\n                                            style=\"color: #fc7643\" (click)=\"archhivePromotion(item.id, item.isDeleted)\"\r\n                                            data-bs-placement=\"top\" [title]=\"item.isDeleted ? 'Unarchive' : 'Archive'\">{{\r\n                                            item.isDeleted ? \"unarchive\" : \"archive\" }}</span>\r\n                                    </button>\r\n                                </div>\r\n                            </td>\r\n                            <!-- <td class=\"text-nowrap\" style=\"text-align: center; vertical-align: middle\"></td> -->\r\n\r\n                        </tr>\r\n                    </ng-container>\r\n                </tbody>\r\n                <tbody *ngIf=\"couponList.length === 0\">\r\n                    <tr class=\"text-center\">\r\n                        <td colspan=\"9\">\r\n                            <img class=\"image-responsive\"\r\n                                src=\"../../../assets/img/icons/spot-illustrations/notfound1.png\" alt=\"notfound1\"\r\n                                width=\"200\" height=\"150\" />\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n            <!-- <mat-paginator sticky class=\"float-right mt-2\" *ngIf=\"couponList.length > 0\"\r\n                [pageSize]=\"partyPageSize\" [pageSizeOptions]=\"[5, 10, 20, 30]\" [length]=\"totalrow\"\r\n                [pageIndex]=\"currentPageNo\" showFirstLastButtons (page)=\"handlePage($event)\" aria-label=\"Select page\">\r\n            </mat-paginator> -->\r\n        </div>\r\n\r\n        <!-- ultiple Unarchive -->\r\n        <div class=\"modal fade\" id=\"errorUnarchiveSelect-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\" role=\"document\" style=\"max-width: 350px\">\r\n                <div class=\"modal-content position-relative\">\r\n                    <div class=\"position-absolute top-0 end-0 mt-2 me-2 z-index-1\">\r\n                        <a class=\"btn-close btn btn-sm btn-circle d-flex flex-center transition-base\"\r\n                            data-bs-dismiss=\"modal\" aria-label=\"Close\"></a>\r\n                    </div>\r\n                    <div class=\"modal-body p-0\">\r\n                        <div class=\"rounded-top-lg py-3 ps-4 pe-6 bg-light\">\r\n                            <h2 class=\"mb-1 text-center font-weight-bold\" style=\"font-weight: 800\"\r\n                                id=\"modalExampleDemoLabel\">\r\n                                <i class=\"fa fa-unlock-alt\" aria-hidden=\"true\"></i> Unarchive\r\n                                Promotions?\r\n                            </h2>\r\n                        </div>\r\n                        <h4 *ngIf=\"isChecked\" class=\"text-center\">\r\n                            Are you sure to unarchive all Promotions?\r\n                        </h4>\r\n                        <h4 *ngIf=\"!isChecked\" class=\"text-center\">\r\n                            Are you sure to unarchive all selected Promotions?\r\n                        </h4>\r\n                    </div>\r\n                    <div class=\"modal-footer justify-content-center\">\r\n                        <a class=\"btn btn-outline-success\" data-bs-dismiss=\"modal\">Close</a>\r\n                        <a *ngIf=\"isChecked\" class=\"btn btn-outline-danger\" data-bs-dismiss=\"modal\"\r\n                            (click)=\"unArchiveMultiplePromotion()\">Unarchive</a>\r\n                        <a *ngIf=\"!isChecked\" class=\"btn btn-outline-danger\" data-bs-dismiss=\"modal\"\r\n                            (click)=\"unArchiveMultiplePromotion()\">Unarchive</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- ultiple Archive -->\r\n        <div class=\"modal fade\" id=\"errorArchiveSelect-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\" role=\"document\" style=\"max-width: 350px\">\r\n                <div class=\"modal-content position-relative\">\r\n                    <div class=\"position-absolute top-0 end-0 mt-2 me-2 z-index-1\">\r\n                        <a class=\"btn-close btn btn-sm btn-circle d-flex flex-center transition-base\"\r\n                            data-bs-dismiss=\"modal\" aria-label=\"Close\"></a>\r\n                    </div>\r\n                    <div class=\"modal-body p-0\">\r\n                        <div class=\"rounded-top-lg py-3 ps-4 pe-6 bg-light\">\r\n                            <h2 class=\"mb-1 text-center font-weight-bold\" style=\"font-weight: 800\"\r\n                                id=\"modalExampleDemoLabel\">\r\n                                <i class=\"fa fa-lock-alt\" aria-hidden=\"true\"></i> Archive\r\n                                Promotions?\r\n                            </h2>\r\n                        </div>\r\n                        <h4 *ngIf=\"isChecked\" class=\"text-center\">\r\n                            Are you sure to archive all Promotions?\r\n                        </h4>\r\n                        <h4 *ngIf=\"!isChecked\" class=\"text-center\">\r\n                            Are you sure to archive all selected Promotions?\r\n                        </h4>\r\n                    </div>\r\n                    <div class=\"modal-footer justify-content-center\">\r\n                        <a class=\"btn btn-outline-success\" data-bs-dismiss=\"modal\">Close</a>\r\n                        <a *ngIf=\"isChecked\" class=\"btn btn-outline-danger\" data-bs-dismiss=\"modal\"\r\n                            (click)=\"archiveMultiplePromotion()\">Archive</a>\r\n                        <a *ngIf=\"!isChecked\" class=\"btn btn-outline-danger\" data-bs-dismiss=\"modal\"\r\n                            (click)=\"archiveMultiplePromotion()\">Archive</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Signle archive  -->\r\n        <div class=\"modal fade\" id=\"errorDelete-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\" role=\"document\" style=\"max-width: 350px\">\r\n                <div class=\"modal-content position-relative\">\r\n                    <div class=\"position-absolute top-0 end-0 mt-2 me-2 z-index-1\">\r\n                        <a class=\"btn-close btn btn-sm btn-circle d-flex flex-center transition-base\"\r\n                            data-bs-dismiss=\"modal\" aria-label=\"Close\"></a>\r\n                    </div>\r\n                    <div class=\"modal-body p-0\">\r\n                        <div class=\"rounded-top-lg py-3 ps-4 pe-6 bg-light\">\r\n                            <h2 *ngIf=\"!isdeletedParty\" class=\"mb-1 text-center font-weight-bold\"\r\n                                style=\"font-weight: 800\" id=\"modalExampleDemoLabel\">\r\n                                Archive Promotion?\r\n                            </h2>\r\n                            <h2 *ngIf=\"isdeletedParty\" class=\"mb-1 text-center font-weight-bold\"\r\n                                style=\"font-weight: 800\" id=\"modalExampleDemoLabel\">\r\n                                Unarchive Promotion?\r\n                            </h2>\r\n                        </div>\r\n                        <h4 class=\"text-center\" *ngIf=\"!isdeletedParty\">\r\n                            Are You Sure To Archive Promotions?\r\n                        </h4>\r\n                        <h4 class=\"text-center\" *ngIf=\"isdeletedParty\">\r\n                            Are You Sure To Unarchive Promotions?\r\n                        </h4>\r\n                    </div>\r\n                    <div class=\"modal-footer justify-content-center\">\r\n                        <a class=\"btn btn-outline-success\" data-bs-dismiss=\"modal\">Close</a>\r\n                        <a class=\"btn btn-outline-danger\" *ngIf=\"!isdeletedParty\" (click)=\"archiveSignlePromotion()\"\r\n                            data-bs-dismiss=\"modal\">Archive\r\n                        </a>\r\n                        <a *ngIf=\"isdeletedParty\" class=\"btn btn-outline-warning\" (click)=\"archiveSignlePromotion()\"\r\n                            data-bs-dismiss=\"modal\">Unarchive\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Flat Discount Modal -->\r\n        <div class=\"modal fade\" id=\"flatDiscount-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\" role=\"document\" style=\"max-width: 350px\">\r\n                <div class=\"modal-content position-relative\">\r\n                    <div class=\"position-absolute top-0 end-0 mt-2 me-2 z-index-1\">\r\n                        <a class=\"btn-close btn btn-sm btn-circle d-flex flex-center transition-base\"\r\n                            data-bs-dismiss=\"modal\" aria-label=\"Close\"></a>\r\n                    </div>\r\n                    <div class=\"modal-body p-0\">\r\n                        <div class=\"rounded-top-lg py-3 ps-4 pe-6 bg-light\">\r\n                            <h2 class=\"mb-1 text-center font-weight-bold\"\r\n                                style=\"font-weight: 800\" id=\"modalExampleDemoLabel\">\r\n                                Flat Discount\r\n                            </h2>\r\n                        </div>\r\n                        <h4 class=\"text-center\">\r\n                        </h4>\r\n                    </div>\r\n                    <div class=\"modal-footer justify-content-center\">\r\n                        <a class=\"btn btn-outline-success\" data-bs-dismiss=\"modal\">Close</a>\r\n                        <a class=\"btn btn-outline-danger\"\r\n                            data-bs-dismiss=\"modal\">Save\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n","import { TitleCasePipe } from '@angular/common';\r\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { Subject, Subscription } from 'rxjs';\r\nimport { CommonService } from 'src/app/core/services/common.service';\r\nimport { PromotionService } from 'src/app/core/services/promotion.service';\r\nimport { ToastNotificationService } from 'src/app/core/services/toast-notification.service';\r\nimport { CouponModalComponent } from '../coupon-modal/coupon-modal.component';\r\nimport { EditCouponComponent } from '../edit-coupon/edit-coupon.component';\r\nimport { debounceTime, distinctUntilChanged, tap } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-coupon',\r\n  templateUrl: './coupon.component.html',\r\n  styleUrls: ['./coupon.component.scss']\r\n})\r\nexport class CouponComponent implements OnInit {\r\n\r\n  private searchSubject = new Subject<string>();\r\n  private searchSubscription: Subscription;\r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  couponList: any[] = [];\r\n  excelFileUpload: any;\r\n  public currentpage: any;\r\n  public totalrow: any;\r\n  public toatlPages: any;\r\n  public currentPageNo: number = 0;\r\n  public partyPageSize: number = 5;\r\n  public pagesize: number = 1;\r\n  public count: number = 0;\r\n  promotionIdList: any[] = [];\r\n  selectedIdList: any[] = [];\r\n\r\n  public archiveIconfalse: boolean = false;\r\n  public checkSingleArray: any = [];\r\n  public isChecked: boolean = false;\r\n  public upiCheckedId = [];\r\n  public upiCheckedId1 = [];\r\n  public allSelect: boolean = false;\r\n  public checkSelect: boolean = false;\r\n\r\n  public checkSelectsingle: boolean = false;\r\n\r\n  public checkSelectsinglefalse: boolean = false;\r\n  public checkSelectsingletrue: boolean = false;\r\n  promotionId: any;\r\n  pageNumberDisplay: any[];\r\n  isLoading: boolean;\r\n  archivedPartyIds: any[];\r\n  unarchivedPartyIds: any[];\r\n  showUnarchiveButton: boolean;\r\n  showDeleteButton: boolean;\r\n  isdeletedParty: boolean;\r\n  selectedTypeFilter: string | null = null;\r\n  isFilterVisible: any;\r\n  @ViewChild('dropdown') dropdown: ElementRef;\r\n\r\n  constructor(public router: Router, public dialog: MatDialog, private commonService: CommonService,\r\n    public route: ActivatedRoute, private promotionService: PromotionService,\r\n    public toastService: ToastNotificationService,\r\n    private titleCasePipe: TitleCasePipe) { }\r\n\r\n  ngOnInit(): void {\r\n    this.getAllCoupons();\r\n    this.commonService.rowAdded$.subscribe(() => {\r\n      // Fetch the updated list of users\r\n      this.getAllCoupons();\r\n    });\r\n\r\n    this.searchSubscription = this.searchSubject\r\n      .pipe(debounceTime(800),\r\n        distinctUntilChanged(),\r\n        tap(() => {\r\n          this.isLoading = true; // Show the loader when the API call is initiated\r\n        })).subscribe(searchKey => {\r\n          // Call the API with the search key\r\n          if (searchKey.length >= 3) {\r\n            this.searchCoupon(searchKey.trim());\r\n          } else if (searchKey === '') {\r\n             this.isLoading = false; // Hide the loader if the search key is less than the threshold\r\n            this.getAllCoupons()\r\n          } else {\r\n            this.isLoading = false; // Hide the loader if the search key is less than the threshold\r\n          }\r\n        });\r\n    }\r\n\r\n  // @HostListener('document:click', ['$event'])\r\n  // onDocumentClick(event: Event): void {\r\n  //   // Check if the clicked element is outside the dropdown\r\n  //   if (!this.dropdown.nativeElement.contains(event.target as Node)) {\r\n  //     this.isFilterVisible = false;\r\n  //   }\r\n  // }\r\n\r\n  getAllCoupons() {\r\n    this.promotionService.getAllCoupons({}, this.currentUser.id).then((res) => {\r\n      if(res.success) {\r\n        this.couponList = res.data;\r\n        // this.currentPageNo = res.data.currentPage;\r\n        // this.totalrow = res.data.totalrows;\r\n        // this.toatlPages = res.data.totalPages\r\n      }\r\n    },\r\n    (err) => {\r\n      if (err.error.expose) {\r\n        this.toastService.toastMsg({\r\n          title: \"Error\",\r\n          content: this.titleCasePipe.transform(err.error.error_message),\r\n        });\r\n      }\r\n      else {\r\n        this.toastService.toastMsg({\r\n          title: \"Error\",\r\n          content: \"Something Went Wrong.\",\r\n        });\r\n      }\r\n\r\n    }) \r\n  }\r\n\r\n  archhivePromotion(promotionId: string, isdeleted: boolean) {\r\n    this.promotionId = promotionId;\r\n    this.isdeletedParty = isdeleted;\r\n    this.selectedIdList.push(promotionId);\r\n  }\r\n\r\n  archiveSignlePromotion() {\r\n    if (this.isdeletedParty) {\r\n      this.promotionService.unArchiveMultiplePromotions({data: { unArchivePromotions: this.selectedIdList }, userId: this.currentUser.id}).then((res: any) => {\r\n        if (res.success) {\r\n          this.toastService.toastMsg({\r\n            title: 'Success',\r\n            content: \"Promotion Unarchived Successfully!!!\"\r\n          });\r\n\r\n          this.getAllCoupons();\r\n        }\r\n      })\r\n    }\r\n    else {\r\n      this.promotionService.deleteMultiplePromotions({data: { archivePromotions: this.selectedIdList }, userId: this.currentUser.id}).then((res: any) => {\r\n        if (res.success) {\r\n          this.toastService.toastMsg({\r\n            title: 'Success',\r\n            content: \"Promotion Archived Successfully!!!\"\r\n          });\r\n          this.getAllCoupons();\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  onChekedsingleCheck(e, partyId) {\r\n    if (e.target.checked) {\r\n      this.promotionIdList.push(partyId);\r\n      this.checkSingleArray.push(e.target.value);\r\n    } else {\r\n      const index = this.promotionIdList.indexOf(partyId);\r\n      if (index !== -1) {\r\n        this.promotionIdList.splice(index, 1);\r\n        this.checkSingleArray.splice(index, 1);\r\n      }\r\n    }\r\n\r\n    // Clear the archived and unarchived party IDs\r\n    this.archivedPartyIds = [];\r\n    this.unarchivedPartyIds = [];\r\n\r\n    // Update the archived and unarchived party IDs based on the selected parties\r\n    this.promotionIdList.forEach(partyId => {\r\n      const party = this.couponList.find(item => item.id === partyId);\r\n      if (party) {\r\n        if (party.isDeleted) {\r\n          this.archivedPartyIds.push(partyId);\r\n        } else {\r\n          this.unarchivedPartyIds.push(partyId);\r\n        }\r\n      }\r\n    })\r\n\r\n    // Check if all the selected parties are archived\r\n    const allArchived = this.promotionIdList.every(partyId => {\r\n      const party = this.couponList.find(item => item.id === partyId);\r\n      return party && party.isDeleted;\r\n    });\r\n\r\n    // Check if all the selected parties are unarchived\r\n    const allUnarchived = this.promotionIdList.every(partyId => {\r\n      const party = this.couponList.find(item => item.id === partyId);\r\n      return party && !party.isDeleted;\r\n    });\r\n\r\n    // if (allArchived && allUnarchived) {\r\n    if (this.archivedPartyIds.length > 0 && this.unarchivedPartyIds.length > 0) {\r\n      // Show an alert error message to the user\r\n      alert(\"Please select either archived or unarchived Promotions.\");\r\n      // Uncheck all the selected parties and header checkbox\r\n      this.promotionIdList = [];\r\n      this.checkSingleArray = [];\r\n      this.checkSelectsingle = false;\r\n      this.upiCheckedId = [];\r\n      this.isChecked = false;\r\n      this.allSelect = false;\r\n      this.checkSelect = false;\r\n      this.checkSelectsingle = false;\r\n\r\n      // Uncheck all the checkboxes in the template\r\n      const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\r\n      checkboxes.forEach((checkbox) => {\r\n        const inputElement = checkbox as HTMLInputElement;\r\n        inputElement.checked = false;\r\n      });\r\n\r\n    } else if (allArchived) {\r\n      console.log('Archived');\r\n      // Show unarchive button\r\n      this.showUnarchiveButton = true;\r\n      this.showDeleteButton = false;\r\n    } else if (allUnarchived) {\r\n      console.log('Unarchived');\r\n      // Show archive button\r\n      this.showDeleteButton = true;\r\n      this.showUnarchiveButton = false;\r\n    } else {\r\n      // Show error message or handle the case when there are both archived and unarchived parties selected\r\n      alert(\"Please select either archived or unarchived Promotions.\");\r\n      // Uncheck all the selected parties and header checkbox\r\n      this.promotionIdList = [];\r\n      this.checkSingleArray = [];\r\n      this.checkSelectsingle = false;\r\n      this.upiCheckedId = [];\r\n      this.isChecked = false;\r\n      this.allSelect = false;\r\n      this.checkSelect = false;\r\n      this.checkSelectsingle = false;\r\n      this.showDeleteButton = false;\r\n      this.showUnarchiveButton = false;\r\n\r\n      // Uncheck all the checkboxes in the template\r\n      const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\r\n      checkboxes.forEach((checkbox) => {\r\n        const inputElement = checkbox as HTMLInputElement;\r\n        inputElement.checked = false;\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  getSingleCheckedId(promotionId) {\r\n    this.promotionId = promotionId;\r\n  }\r\n\r\n  onChekMultiple($event) {\r\n    const isChecked = $event.target.checked;\r\n    if (isChecked) {\r\n      this.promotionIdList = this.couponList.map(item => item.id);\r\n    } else {\r\n      this.promotionIdList = [];\r\n      this.showDeleteButton = false;\r\n      this.showUnarchiveButton = false\r\n    }\r\n    this.checkSelect = isChecked; // Update the checkbox state in the header\r\n\r\n    let id = $event.target.value;\r\n    this.isChecked = $event.target.checked;\r\n    this.upiCheckedId = this.couponList.map((item) => {\r\n      if (id === -1) {\r\n        if (this.isChecked == true) {\r\n          this.checkSelectsingle = true;\r\n          return item.id;\r\n        }\r\n        else {\r\n          this.checkSelectsingle = false;\r\n          this.upiCheckedId = [];\r\n        }\r\n      }\r\n    })\r\n    // Clear the archived and unarchived party IDs\r\n    this.archivedPartyIds = [];\r\n    this.unarchivedPartyIds = [];\r\n\r\n    // Update the archived and unarchived party IDs based on the selected parties\r\n    this.promotionIdList.forEach(partyId => {\r\n      const party = this.couponList.find(item => item.id === partyId);\r\n      if (party) {\r\n        if (party.isDeleted) {\r\n          this.archivedPartyIds.push(partyId);\r\n        } else {\r\n          this.unarchivedPartyIds.push(partyId);\r\n        }\r\n      }\r\n\r\n      // Check if all the selected parties are archived\r\n      const allArchived = this.promotionIdList.every(partyId => {\r\n        const party = this.couponList.find(item => item.id === partyId);\r\n        return party && party.isDeleted;\r\n      });\r\n      // Check if all the selected parties are unarchived\r\n      const allUnarchived = this.promotionIdList.every(partyId => {\r\n        const party = this.couponList.find(item => item.id === partyId);\r\n        return party && !party.isDeleted;\r\n      });\r\n\r\n      if (allArchived) {\r\n        // Show unarchive button\r\n        this.showUnarchiveButton = true\r\n        this.showDeleteButton = false;\r\n      } else if (allUnarchived) {\r\n        // Show archive button\r\n        this.showDeleteButton = true;\r\n        this.showUnarchiveButton = false\r\n      } else {\r\n        // Show error message or handle the case when there are both archived and unarchived parties selected\r\n      }\r\n    });\r\n\r\n    if (this.archivedPartyIds.length > 0 && this.unarchivedPartyIds.length > 0) {\r\n      alert(\"Please select either archived or unarchived Promotions\");\r\n      // Uncheck all the selected parties and header checkbox\r\n      this.promotionIdList = [];\r\n      this.checkSingleArray = [];\r\n      this.checkSelectsingle = false;\r\n      this.upiCheckedId = [];\r\n      this.isChecked = false;\r\n      this.allSelect = false;\r\n      this.checkSelect = false;\r\n      this.checkSelectsingle = false;\r\n\r\n      // Uncheck all the checkboxes in the template\r\n      const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\r\n      checkboxes.forEach((checkbox) => {\r\n        const inputElement = checkbox as HTMLInputElement;\r\n        inputElement.checked = false;\r\n      });\r\n\r\n      // Throw an error to prevent further processing\r\n      this.toastService.toastMsg({\r\n        title: 'Warning',\r\n        content: 'Please select either archived or unarchived Promotions'\r\n      })\r\n      throw new Error(\"Please select either archived or unarchived Promotions\");\r\n    }\r\n  }\r\n\r\n  getUPIcheckId(promotionId) {\r\n    this.promotionId = promotionId;\r\n  }\r\n\r\n  archiveMultiplePromotion() {\r\n    if (this.currentPageNo === 1) {\r\n      this.currentPageNo = this.currentPageNo;\r\n    }\r\n    else {\r\n      if (this.toatlPages > this.currentPageNo) {\r\n        this.currentPageNo = this.currentPageNo - 1;\r\n      }\r\n    }\r\n    const requestBody = {\r\n      archivePromotions: this.promotionIdList\r\n    };\r\n\r\n    this.promotionService.deleteMultiplePromotions({ data: requestBody, userId: this.currentUser.id }).then((result: any) => {\r\n      if (result.success) {\r\n        this.getAllCoupons();\r\n        this.toastService.toastMsg({\r\n          title: 'Success',\r\n          content: \"Promotion Archived Successfully!!!\"\r\n        });\r\n\r\n        this.showDeleteButton = false;\r\n        this.showUnarchiveButton = false\r\n        this.promotionIdList = []; // Clear the selected party IDs after deletion\r\n        this.checkSelect = false // Reset the checkbox state in the header\r\n      }\r\n    }, (err) => {\r\n      if (err.error.expose) {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: this.titleCasePipe.transform(err.error.error_message)\r\n        });\r\n      } else {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: \"Something Went Wrong.\"\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  showDeleteButtonFunc(): boolean {\r\n    return this.unarchivedPartyIds.length > 0;\r\n  }\r\n\r\n  unArchiveMultiplePromotion() {\r\n    const requestBody = {\r\n      unArchivePromotions: this.promotionIdList\r\n    };\r\n    this.promotionService.unArchiveMultiplePromotions({data: requestBody, userId: this.currentUser.id}).then((result: any) => {\r\n      if (result.success) {\r\n        this.getAllCoupons();\r\n        this.toastService.toastMsg({\r\n          title: 'Success',\r\n          content: \"Promotion Unarchived Successfully!!!\"\r\n        });\r\n        this.showDeleteButton = false;\r\n        this.showUnarchiveButton = false\r\n        this.promotionIdList = []; // Clear the selected party IDs after unarchiving\r\n        this.checkSelect = false; // Reset the checkbox state in the header\r\n      }\r\n    }, (err) => {\r\n      if (err.error.expose) {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: this.titleCasePipe.transform(err.error.error_message)\r\n        });\r\n      } else {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: \"Something Went Wrong.\"\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  searchCoupon(searchKey: string) {\r\n    setTimeout(() => {\r\n      if (searchKey.trim() === '') {\r\n        this.getAllCoupons();\r\n        this.isLoading = false; \r\n      } else {\r\n        this.isLoading = false; \r\n        this.couponList = this.couponList.filter(item => {\r\n          return (\r\n            (item.coupon_name && item.coupon_name.toLowerCase().includes(searchKey.toLowerCase())) ||\r\n            (item.coupon_code && item.coupon_code.toLowerCase().includes(searchKey.toLowerCase()))\r\n          );\r\n        });\r\n        if(this.couponList.length === 0){\r\n          this.isLoading = false; \r\n          this.toastService.toastMsg({\r\n            title: \"Error\",\r\n            content: searchKey + \" Is Not Found\",\r\n          });\r\n        }\r\n      }\r\n    this.isLoading = false; // Hide the loader after the API call is completed\r\n    }, 500);\r\n  }\r\n\r\n\r\n  onSearchInputChange(searchKey: string) {\r\n    console.log(searchKey);\r\n    // Emit the search key to the searchSubject\r\n    this.searchSubject.next(searchKey.trim());\r\n  }\r\n\r\n  handleInputChange(e) {\r\n    this.excelFileUpload = e.target.files[0];\r\n    const pattern = /\\.(xlsx|xls)$/i; // Pattern to match \".xlsx\" or \".xls\" extension\r\n    if (!pattern.test(this.excelFileUpload.name)) {\r\n      this.toastService.toastMsg({\r\n        title: \"Error\",\r\n        content: \"Invalid Format. Please Select An Excel File.\",\r\n      });\r\n      return;\r\n    }\r\n    if (this.excelFileUpload) {\r\n      let formdata = new FormData();\r\n      formdata.set(\"file\", this.excelFileUpload)\r\n      // this.truckOwnerService.postBulkowner(formdata, this.currentUser.id).then((res) => {\r\n      //   this.toastService.toastMsg({\r\n      //     title: \"Success\",\r\n      //     content: \"Excel Uploaded Successfully\",\r\n      //   });\r\n      //   this.getAllCoupons();\r\n      // }, (err) => {\r\n      //   if (err.error.expose) {\r\n      //     this.toastService.toastMsg({\r\n      //       title: \"Error\",\r\n      //       content: this.titleCasePipe.transform(err.error.error_message),\r\n      //     });\r\n      //   }\r\n      //   else if (err.error.status == \"409\" && err.error.expose == false) {\r\n      //     this.toastService.toastMsg({\r\n      //       title: \"Error\",\r\n      //       content: \"List Of Consignments Already Exists\",\r\n      //     });\r\n      //   }\r\n      //   else {\r\n      //     this.toastService.toastMsg({\r\n      //       title: \"Error\",\r\n      //       content: \"Something Went Wrong.\",\r\n      //     });\r\n      //   }\r\n      // });\r\n    }\r\n  }\r\n\r\n  startUpload() {\r\n    var uploadInput = document.getElementById('uploadFile');\r\n    if (uploadInput) {\r\n      var event = new MouseEvent('click', {\r\n        view: window,\r\n        bubbles: false,\r\n        cancelable: true\r\n      });\r\n      uploadInput.dispatchEvent(event);\r\n    } else {\r\n      this.toastService.toastMsg({\r\n        title: 'Error',\r\n        content: \"Upload element not found\"\r\n      });\r\n    }\r\n  }\r\n\r\n  public handlePage(e: any) {\r\n    this.currentPageNo = e.pageIndex;\r\n    this.pagesize = e.pageSize;\r\n\r\n    if (this.couponList.length > 0) {\r\n      // if (this.searchKey !== '') {\r\n      //   this.partyPageSize = e.pageSize;\r\n      //   this.searchConsignment(this.searchKey);\r\n      // } else {\r\n        this.partyPageSize = e.pageSize;\r\n        this.getAllCoupons();\r\n      // }\r\n    }\r\n  }\r\n    \r\n  couponsModal(): void {\r\n    const dialogRef: MatDialogRef<CouponModalComponent> = this.dialog.open(CouponModalComponent, {\r\n      width: '650px',\r\n      height: \"100vh\",\r\n      data: {},\r\n      disableClose: true,\r\n      position: {\r\n        right: '0',\r\n      },\r\n    });\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      console.log(`Dialog result: ${result}`);\r\n    });\r\n  }\r\n\r\n  // assignProduct(promotionId): void {\r\n  //   const dialogRef: MatDialogRef<AssignProductToPromotionComponent> = this.dialog.open(AssignProductToPromotionComponent, {\r\n  //     width: 'auto',\r\n  //     height: \"auto\",\r\n  //     data: { promotionId: promotionId},\r\n  //     disableClose: true,\r\n  //   });\r\n  //   dialogRef.afterClosed().subscribe((result) => {\r\n  //     console.log(`Dialog result: ${result}`);\r\n  //   });\r\n  // }\r\n\r\n  editCouponModal(couponData) {\r\n    const dialogRef: MatDialogRef<EditCouponComponent> = this.dialog.open(EditCouponComponent, {\r\n      width: '700px',\r\n      height: '100vh',\r\n      data: { couponData: couponData },\r\n      disableClose: true,\r\n      position: {\r\n        right: '0',\r\n      },\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      console.log(`Dialog result: ${result}`);\r\n    });\r\n  }\r\n\r\n  isActive(couponData, isActive) {\r\n    const newStatus = !isActive; // Toggle between '1' and '0'\r\n    const data = {\r\n      couponId: couponData.id,\r\n      couponData: {\r\n          coupon_code: couponData.coupon_code,\r\n          coupon_name: couponData.coupon_name,\r\n          discount_percentage: couponData.discount_percentage,\r\n          start_date: couponData.start_date,\r\n          end_date: couponData.end_date,\r\n          \"is_valid\": newStatus,\r\n          usage_limit: couponData.usage_limit,\r\n          max_discount_amount: couponData.max_discount_amount\r\n      }\r\n    }\r\n    this.promotionService.updateCoupon(data, this.currentUser.id)\r\n      .then( res => {\r\n        if (res.success) {\r\n          if (newStatus) {\r\n            this.toastService.toastMsg({\r\n              title: \"Success\",\r\n              content: \"Status Has Changed To Active\",\r\n            });\r\n            this.getAllCoupons()\r\n          } else {\r\n            this.toastService.toastMsg({\r\n              title: \"Success\",\r\n              content: \"Status Has Changed To Inactive\",\r\n            });\r\n            this.getAllCoupons()\r\n          }\r\n        }\r\n      },(err) => {\r\n          if (err.error.status === 404) {\r\n              this.toastService.toastMsg({\r\n                title: 'Error',\r\n                content: \"Data Not Found!!!\"\r\n              })\r\n          } else {\r\n            this.toastService.toastMsg({\r\n              title: 'Error',\r\n              content: this.titleCasePipe.transform(err.error.error_message)\r\n            })\r\n          }\r\n      })\r\n      .catch((error) => {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: this.titleCasePipe.transform(error.error.error_message)\r\n        })\r\n      });\r\n  }\r\n\r\n  // Add a method to update the filter value\r\n  updateTypeFilter(filterValue: string | null) {\r\n    if(filterValue === 'ALL') {\r\n      this.selectedTypeFilter = null;\r\n    } else {\r\n      this.selectedTypeFilter = filterValue;\r\n    }\r\n  }\r\n\r\n  toggleFilter() {\r\n    this.isFilterVisible = !this.isFilterVisible;\r\n  }\r\n\r\n  closeDropdown() {\r\n    this.isFilterVisible = false;\r\n  }\r\n\r\n}\r\n","<div class=\"modal-header pt-0\">\r\n    <h1 style=\"color: #EB8B3F; font-weight: bolder;margin-left: 5px;\" class=\"modal-title mb-0\">Update Coupons</h1>\r\n\r\n    <div class=\"addProductButtons\">\r\n        <button type=\"button\" style=\"margin-right: 10px;\" class=\"btn btn-cancel\" (click)=\"cancel()\">Cancel</button>\r\n        <button type=\"button\" class=\"btn btn-save ms-2\" (click)=\"onSave()\">Save</button>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal-body\">\r\n    <form [formGroup]=\"promotionForm\">\r\n        <div class=\"row mb-3\">\r\n            <div style=\"font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n              <label class=\"form-label\">Coupon Name<span class=\"error-asterisk\">*</span></label>\r\n              <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <input matInput placeholder=\"Coupon Name\" maxlength=\"50\" formControlName=\"coupon_name\" required>\r\n              </mat-form-field>\r\n              <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.coupon_name.touched) && f.coupon_name.errors?.required\">\r\n                Coupon name is required!\r\n              </mat-error>\r\n            </div>\r\n            <div style=\"font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n              <label class=\"form-label\">Coupon Code<span class=\"error-asterisk\">*</span></label>\r\n              <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <input matInput style=\"text-transform :uppercase\" placeholder=\"Coupon Code\" maxlength=\"8\" minlength=\"3\" formControlName=\"coupon_code\" required>\r\n                <span matSuffix>\r\n                  <a style=\"cursor: pointer; color: 110152;\" (click)=\"generateCoupon()\" matTooltip=\"Generate Coupon\">\r\n                    <i class=\"fas fa-sync-alt\"></i>\r\n                  </a>\r\n                </span>\r\n              </mat-form-field>\r\n              <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.coupon_code.touched) && f.coupon_code.errors?.required\">\r\n                Coupon Code is required!\r\n              </mat-error>\r\n              <mat-error class=\"text-danger\" *ngIf=\"f.coupon_code.errors?.minlength\">\r\n                Coupon Code must be greater than 3 characters!\r\n              </mat-error>\r\n            </div>\r\n        </div>         \r\n\r\n        <div class=\"row mb-3\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Percentage</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Discount Percentage\" maxlength=\"3\" formControlName=\"discountPercentage\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix>%</span>\r\n                </mat-form-field>\r\n                <mat-error *ngIf=\"f.discountPercentage.errors?.max\">\r\n                    Discount Percentage cannot exceed 100%.\r\n                </mat-error>\r\n            </div>\r\n            \r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Upto</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Max Discount Amount\" maxlength=\"10\" formControlName=\"maxDiscountAmount\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix>&nbsp;</span>\r\n                </mat-form-field>\r\n            </div>\r\n\r\n        </div>\r\n        \r\n        <div class=\"row mb-3\">\r\n          <label class=\"form-label\">Description <span class=\"error-asterisk\">*</span></label>\r\n          <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n            <textarea matInput autocomplete=\"off\" formControlName=\"description\" rows=\"3\" maxlength=\"150\" placeholder=\"Description\">\r\n            </textarea>\r\n          </mat-form-field>\r\n        </div>\r\n\r\n        <div class=\"row mb-3\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Start date<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field style=\"font-size: 12px\" class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput bsDatepicker required placeholder=\"Start Date\" class=\"text-uppercase\" formControlName=\"startDate\"\r\n                      bsDatepicker [bsConfig]=\"{\r\n                        containerClass: 'theme-dark-blue',\r\n                        dateInputFormat: 'DD MMM YYYY',\r\n                        showWeekNumbers: false\r\n                      }\" [ngClass]=\"{\r\n                        'is-invalid':\r\n                          f.startDate.invalid && f.startDate.touched && submitted\r\n                      }\" (click)=\"openDatepicker('startDate')\" />\r\n                    <span>\r\n                      <mat-icon class=\"iconcalender\">date_range</mat-icon>\r\n                    </span>\r\n                  </mat-form-field>\r\n                  <mat-error class=\"text-danger\" *ngIf=\"\r\n                      (submitted || f.startDate.touched) &&\r\n                      f.startDate.errors?.required\r\n                    \">\r\n                    Start Date is Required!\r\n                  </mat-error>\r\n            </div>\r\n            \r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Expiry Date<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field style=\"font-size: 12px\" class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput bsDatepicker placeholder=\"Expiry Date\" [minDate]=\"calculateMinDate()\"\r\n                      class=\"text-uppercase\" formControlName=\"expiryDate\" bsDatepicker required [bsConfig]=\"{\r\n                        containerClass: 'theme-dark-blue',\r\n                        dateInputFormat: 'DD MMM YYYY',\r\n                        showWeekNumbers: false,\r\n                        showOnFocus: true\r\n                      }\" (click)=\"openDatepicker('expiryDate')\" />\r\n                    <span>\r\n                      <mat-icon class=\"iconcalender\">date_range</mat-icon>\r\n                    </span>\r\n                  </mat-form-field>\r\n                  <mat-error class=\"text-danger\" *ngIf=\"\r\n                      (submitted || f.expiryDate.touched) &&\r\n                      f.expiryDate.errors?.required\r\n                    \">\r\n                    Expiry Date is Required!\r\n                  </mat-error>\r\n            </div>\r\n\r\n        </div>\r\n\r\n        <div class=\"row mb-3\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Usage Limit</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Usage Limit\" maxlength=\"8\" formControlName=\"usage_limit\" (keypress)=\"numberOnly($event)\">\r\n                </mat-form-field>\r\n                <!-- <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.usage_limit.touched) && f.usage_limit.errors?.required\">\r\n                    Usage Limit is required!\r\n                </mat-error> -->\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </form>    \r\n</div>","import { TitleCasePipe } from '@angular/common';\r\nimport { Component, Inject, OnInit } from '@angular/core';\r\nimport { FormBuilder, Validators } from '@angular/forms';\r\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { Router } from '@angular/router';\r\nimport * as moment from 'moment';\r\nimport { CommonService } from 'src/app/core/services/common.service';\r\nimport { PromotionService } from 'src/app/core/services/promotion.service';\r\nimport { ToastNotificationService } from 'src/app/core/services/toast-notification.service';\r\n\r\n@Component({\r\n  selector: 'app-edit-coupon',\r\n  templateUrl: './edit-coupon.component.html',\r\n  styleUrls: ['./edit-coupon.component.scss']\r\n})\r\nexport class EditCouponComponent implements OnInit {\r\n\r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  public submitted: boolean = false;\r\n  promotionForm: any;\r\n  couponData: any;\r\n  public maxDate: Date;\r\n  currentPageNo: any;\r\n  promotionList: any;\r\n  totalrow: any;\r\n  toatlPages: any;\r\n  selectedProductIds: string[] = [];\r\n  selectedFreeProductIds: string[] = [];\r\n  types: string[] = ['DISCOUNT', 'PRODUCT', 'FLAT'];   //['DISCOUNT', 'PRODUCT', 'FLAT', 'COUPONS'];\r\n  productsIdList: any[] = [];\r\n  freeProductData: any;\r\n  \r\n  constructor(public router: Router, private commonService: CommonService,\r\n    private toastService: ToastNotificationService, public dialog: MatDialog,\r\n    private titleCasePipe: TitleCasePipe, private formBuilder: FormBuilder,\r\n    @Inject(MAT_DIALOG_DATA) public data: any,\r\n    public dialogRef: MatDialogRef<EditCouponComponent>,\r\n    private promotionService: PromotionService) { \r\n      this.couponData = this.data.couponData;\r\n    }\r\n\r\n  ngOnInit(): void {\r\n    try {\r\n      this.promotionForm = this.formBuilder.group({\r\n        coupon_name: [null, Validators.required],\r\n        coupon_code: [null, Validators.required],\r\n        usage_limit: [null],\r\n        startDate: [null, Validators.required],\r\n        discountPercentage: [null, [Validators.min(0), Validators.max(100)]],\r\n        maxDiscountAmount: [null],\r\n        expiryDate: [null, Validators.required],\r\n        description: [null],\r\n      })\r\n      this.getCouponData()\r\n\r\n    } catch (error) {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: error\r\n        })\r\n    }\r\n  }\r\n\r\n  get f() {\r\n    return this.promotionForm.controls;\r\n  }\r\n\r\n  generateCoupon() {\r\n    this.promotionService.generateCoupon({}, this.currentUser.id).then((res) => {\r\n      if (res.success) {\r\n        this.promotionForm.patchValue({\r\n          coupon_code: res.data\r\n        })\r\n      }\r\n    }, (err) => {\r\n      if (err.error.expose) {\r\n        this.toastService.toastMsg({\r\n          title: \"Error\",\r\n          content: this.titleCasePipe.transform(err.error.error_message),\r\n        });\r\n      }\r\n      else {\r\n        this.toastService.toastMsg({\r\n          title: \"Error\",\r\n          content: \"Something Went Wrong.\",\r\n        });\r\n      }\r\n    })\r\n  }\r\n  \r\n  getCouponData() {\r\n    // this.promotionService.getPromotionById({}).then((res) => {\r\n    //   if(res.success) {\r\n    //     this.promotionList = res.data;\r\n        this.promotionForm.patchValue({\r\n          coupon_code: this.couponData.coupon_code,\r\n          usage_limit: this.couponData.usage_limit,\r\n          coupon_name: this.couponData.coupon_name,\r\n          discountPercentage: this.couponData?.discount_percentage,\r\n          maxDiscountAmount: this.couponData?.max_discount_amount,\r\n          description: this.couponData?.description,\r\n          expiryDate: this.couponData.end_date ? (moment(this.couponData.end_date).format(\"DD-MMM-YYYY\")) : (moment(this.maxDate).format(\"DD-MMM-YYYY\")),\r\n          startDate: this.couponData.start_date ? (moment(this.couponData.start_date).format(\"DD-MMM-YYYY\")) : (moment(this.maxDate).format(\"DD-MMM-YYYY\")),\r\n        })\r\n    //     // If you have product data, then fetching the whole product data into the array list\r\n    //     this.productsIdList = res.data.products;\r\n    //     this.freeProductData = res.data.freeProduct;\r\n\r\n    //     // Add product Id into the selectedProductIds array for each product\r\n    //     for (const product of this.productsIdList) {\r\n    //       this.selectedProductIds.push(product.id)\r\n    //     }\r\n        \r\n    //   }\r\n    //   },(err) => {\r\n    //     if (err.error.status === 404) {\r\n    //         this.toastService.toastMsg({\r\n    //           title: 'Error',\r\n    //           content: \"Data Not Found!!!\"\r\n    //         })\r\n    //     } else {\r\n    //       this.toastService.toastMsg({\r\n    //         title: 'Error',\r\n    //         content: this.titleCasePipe.transform(err.error.error_message)\r\n    //       })\r\n    //     }\r\n    //   });\r\n  }\r\n\r\n  \r\n  numberOnly(event): boolean {\r\n    const charCode = (event.which) ? event.which : event.keyCode;\r\n    if (charCode > 31 && (charCode < 48 || charCode > 57)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  onSave() {\r\n    this.submitted = true;\r\n    console.log(this.promotionForm)\r\n    if (this.promotionForm.invalid) {\r\n      this.toastService.toastMsg({\r\n        title: \"Error\",\r\n        content: \"Fill All Required Fields.\",\r\n      });\r\n      return false;\r\n    } else {\r\n      const data = {\r\n        couponId: this.couponData.id,\r\n        couponData: {\r\n            coupon_code: this.promotionForm.value.coupon_code.toUpperCase(),\r\n            coupon_name: this.promotionForm.value.coupon_name,\r\n            discount_percentage: this.promotionForm.value.discountPercentage,\r\n            start_date: this.promotionForm.value.startDate,\r\n            end_date: this.promotionForm.value.expiryDate,\r\n            // \"is_valid\": true,\r\n            usage_limit: this.promotionForm.value.usage_limit,\r\n            max_discount_amount: this.promotionForm.value.maxDiscountAmount,\r\n            description: this.promotionForm.value.description\r\n        }\r\n      }\r\n      this.promotionService.updateCoupon(data, this.currentUser.id)\r\n        .then( res => {\r\n          if(res.success) {\r\n            this.dialogRef.close();\r\n            this.commonService.notifyDataAdded()\r\n            this.toastService.toastMsg({\r\n              title: \"Success\",\r\n              content: \"Coupon Updated Successfully!!!\",\r\n            });\r\n          }\r\n        },(err) => {\r\n            if (err.error.status === 404) {\r\n                this.toastService.toastMsg({\r\n                  title: 'Error',\r\n                  content: \"Data Not Found!!!\"\r\n                })\r\n            } else {\r\n              this.toastService.toastMsg({\r\n                title: 'Error',\r\n                content: this.titleCasePipe.transform(err.error.error_message)\r\n              })\r\n            }\r\n        });\r\n    }\r\n  }\r\n\r\n  cancel() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n  openDatepicker(dateType){\r\n    // Check if the current value of taskdate is an \"Invalid Date\"\r\n    if(dateType === 'startDate') {\r\n      const selectedDate = this.promotionForm.get('startDate').value;\r\n      if (isNaN(selectedDate.getTime())) {\r\n        // Set a default date or any valid date here\r\n        this.promotionForm.get('startDate').setValue(new Date());\r\n      }\r\n    } else if(dateType === 'expiryDate') {\r\n      const selectedDate = this.promotionForm.get('expiryDate').value;\r\n      if (isNaN(selectedDate.getTime())) {\r\n        // Set a default date or any valid date here\r\n        this.promotionForm.get('expiryDate').setValue(new Date());\r\n      }\r\n    }\r\n  }\r\n\r\n  calculateMinDate() {\r\n    const expiryDate = this.promotionForm.get('startDate').value;\r\n    // Assuming expiryDate is a valid Date object\r\n    if (expiryDate) {\r\n        const minDate = new Date(expiryDate);\r\n        minDate.setDate(minDate.getDate() + 1); // Setting the minimum date as one day after joining date\r\n        return minDate;\r\n    }\r\n    return null; // or you can set a default minDate if joiningDate is not set\r\n  }\r\n}\r\n","<div class=\"modal-header pt-0\">\r\n    <h1 style=\"color: #EB8B3F; font-weight: bolder;margin-left: 5px;\" class=\"modal-title mb-0\">Edit Promotion</h1>\r\n\r\n    <div class=\"addProductButtons\">\r\n        <button type=\"button\" style=\"margin-right: 10px;\" class=\"btn-cancel\" (click)=\"cancel()\">Cancel</button>\r\n        <button type=\"button\" class=\"btn-save ms-2\" (click)=\"onSave()\">Save</button>\r\n    </div>\r\n</div>\r\n\r\n<div class=\"modal-body\">\r\n    <form [formGroup]=\"promotionForm\">\r\n        <div class=\"row mb-3\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Schema Name<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Schema Name\" maxlength=\"50\" formControlName=\"schemaName\" required>\r\n                </mat-form-field>\r\n                <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.schemaName.touched) && f.schemaName.errors?.required\">\r\n                    Schema Name is required!\r\n                </mat-error>\r\n            </div>\r\n\r\n            <div style=\"font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Type<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                  <mat-select formControlName=\"type\" placeholder=\"Type\" required [disabled]=\"promotionForm.get('type').value === 'PRODUCT'\">\r\n                    <mat-option *ngFor=\"let item of types\" [value]=\"item\">\r\n                      {{ item }}\r\n                    </mat-option>\r\n                  </mat-select>\r\n                </mat-form-field>\r\n                <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.type.touched) && f.type.errors?.required\">\r\n                  Schema Type is required!\r\n                </mat-error>\r\n            </div>              \r\n        </div>\r\n\r\n        <div class=\"row mb-3\" *ngIf=\"f.type.value === 'DISCOUNT' \">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Percentage</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Discount Percentage\" maxlength=\"3\" formControlName=\"discountPercentage\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix>%</span>\r\n                </mat-form-field>\r\n                <mat-error *ngIf=\"f.discountPercentage.errors?.max\">\r\n                    Discount Percentage cannot exceed 100%.\r\n                </mat-error>\r\n            </div>\r\n            \r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Amount</label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Discount Amount\" maxlength=\"10\" formControlName=\"discountAmount\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix>&nbsp;</span>\r\n                </mat-form-field>\r\n            </div>\r\n\r\n            <!-- Display error for both fields having errors and at least one being touched or submitted -->\r\n            <div *ngIf=\"promotionForm.hasError('atLeastOneError') && submitted\" class=\"text-danger\">\r\n                Please fill at least one of Discounted Amount or Discount Percentage.\r\n            </div>\r\n        </div>\r\n        \r\n        <div class=\"row mb-3\" *ngIf=\"f.type.value === 'FLAT'\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Minimum Bill Amount<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <span class=\"matSuffix\" matSuffix>&nbsp;</span>\r\n                    <input matInput placeholder=\"Discount Percentage\" maxlength=\"10\" formControlName=\"minBillAmt\" (keypress)=\"numberOnly($event)\">\r\n                </mat-form-field>\r\n            </div>\r\n            \r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Discount Amount<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Discount Amount\" maxlength=\"10\" formControlName=\"discountAmount\" (keypress)=\"numberOnly($event)\">\r\n                    <span class=\"matSuffix\" matSuffix>&nbsp;</span>\r\n                </mat-form-field>\r\n            </div>\r\n\r\n            <!-- Display error for both fields having errors and at least one being touched or submitted -->\r\n            <div *ngIf=\"promotionForm.hasError('atLeastOneError') && submitted\" class=\"text-danger\">\r\n                Please fill at least one of Discounted Amount\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"row mb-3\" *ngIf=\"f.type.value !== 'FLAT'\">\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Buy Quantity<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <input matInput placeholder=\"Buy Quantity\" maxlength=\"5\" formControlName=\"buyQuantity\" (keypress)=\"numberOnly($event)\">\r\n                </mat-form-field>\r\n                <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.buyQuantity.touched) && f.buyQuantity.errors?.required\">\r\n                    Buy quantity is required!\r\n                </mat-error>\r\n            </div>\r\n\r\n            <div style=\" font-size: 12px\" class=\"col-xs-12 col-sm-12 col-md-6 col-lg-6\">\r\n                <label class=\"form-label\">Get Quantity<span class=\"error-asterisk\">*</span></label>\r\n                <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                    <div style=\"display: inline-block;\">\r\n                        <input matInput placeholder=\"Get Quantity\" maxlength=\"5\" formControlName=\"getQuantity\" (keypress)=\"numberOnly($event)\">\r\n                    </div>\r\n                </mat-form-field>\r\n                <mat-error class=\"text-danger\" *ngIf=\"(submitted || f.getQuantity.touched) && f.getQuantity.errors?.required\">\r\n                    Get quantity is required!\r\n                </mat-error>\r\n            </div>\r\n        </div>\r\n    </form>      \r\n        \r\n    <div class=\"row mt-3\">\r\n        <div class=\"col-xs-12 col-sm-12 col-md-12 col-lg-12\" *ngIf=\"productsIdList.length\">\r\n            <label class=\"form-label\">Products<span class=\"error-asterisk\">*</span></label>\r\n            <mat-form-field class=\"example-full-width\" appearance=\"outline\">\r\n                <mat-select [(ngModel)]=\"selectedProductIds\" multiple>\r\n                    <mat-option *ngFor=\"let product of productsIdList\" [value]=\"product.id\">\r\n                    {{ product.itemName }}\r\n                    </mat-option>\r\n                </mat-select>\r\n            </mat-form-field>  \r\n        </div>\r\n\r\n        <div class=\"col-xs-12 col-sm-12 col-md-12 col-lg-12 mt-3\" *ngIf=\"freeProductData\">\r\n            <label class=\"form-label\">Free Products<span class=\"error-asterisk\">*</span></label>\r\n            <ul class=\"mt-2\">{{ freeProductData.itemName }}</ul>  \r\n        </div>\r\n    </div>\r\n</div>","import { TitleCasePipe } from '@angular/common';\r\nimport { Component, Inject, OnInit } from '@angular/core';\r\nimport { AbstractControl, FormArray, FormBuilder, FormControl, FormGroup, ValidationErrors, ValidatorFn, Validators } from '@angular/forms';\r\nimport { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { Router } from '@angular/router';\r\nimport { CommonService } from 'src/app/core/services/common.service';\r\nimport { PromotionService } from 'src/app/core/services/promotion.service';\r\nimport { ToastNotificationService } from 'src/app/core/services/toast-notification.service';\r\n\r\n@Component({\r\n  selector: 'app-edit-promotion',\r\n  templateUrl: './edit-promotion.component.html',\r\n  styleUrls: ['./edit-promotion.component.scss']\r\n})\r\nexport class EditPromotionComponent implements OnInit {\r\n\r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  public submitted: boolean = false;\r\n  promotionForm: any;\r\n  promotionId: any;\r\n  currentPageNo: any;\r\n  promotionList: any;\r\n  totalrow: any;\r\n  toatlPages: any;\r\n  selectedProductIds: string[] = [];\r\n  selectedFreeProductIds: string[] = [];\r\n  types: string[] = ['DISCOUNT', 'PRODUCT', 'FLAT'];   //['DISCOUNT', 'PRODUCT', 'FLAT', 'COUPONS'];\r\n  productsIdList: any[] = [];\r\n  freeProductData: any;\r\n  \r\n  constructor(public router: Router, private commonService: CommonService,\r\n    private toastService: ToastNotificationService, public dialog: MatDialog,\r\n    private titleCasePipe: TitleCasePipe, private formBuilder: FormBuilder,\r\n    @Inject(MAT_DIALOG_DATA) public data: any,\r\n    public dialogRef: MatDialogRef<EditPromotionComponent>,\r\n    private promotionService: PromotionService) { \r\n      this.promotionId = this.data.promotionId;\r\n    }\r\n\r\n  ngOnInit(): void {\r\n    try {\r\n      this.promotionForm = this.formBuilder.group({\r\n          schemaName: [null],\r\n          buyQuantity: [null, Validators.required],\r\n          getQuantity: [null, Validators.required],\r\n          discountPercentage: [null, [Validators.min(0), Validators.max(100)]],\r\n          discountAmount: [null],\r\n          minBillAmt: [null],\r\n          type: ['DISCOUNT', Validators.required], // Default value 'DISCOUNT'\r\n          products: this.formBuilder.array([]),   // Initialize \"products\" as an array here\r\n      },\r\n      {\r\n        validators: [\r\n            this.atLeastOneValidator\r\n        ], // Apply the custom validator\r\n      });\r\n      this.getPromotionById()\r\n      \r\n      const discountPercentageControl = this.promotionForm.get('discountPercentage');\r\n      const discountAmountControl = this.promotionForm.get('discountAmount');\r\n\r\n      // Subscribe to valueChanges of discountPercentage control\r\n      discountPercentageControl?.valueChanges.subscribe(value => {\r\n          try {\r\n              if (value && !discountAmountControl?.disabled) {\r\n                  discountAmountControl?.disable();\r\n              } else if (!value && discountAmountControl?.disabled) {\r\n                  discountAmountControl?.enable();\r\n              }\r\n          } catch (error) {\r\n              console.error('Error in discountPercentageControl subscription:', error);\r\n          }\r\n      });\r\n\r\n      // Subscribe to valueChanges of discountAmount control\r\n      discountAmountControl?.valueChanges.subscribe(value => {\r\n          try {\r\n              if (value && !discountPercentageControl?.disabled) {\r\n                  discountPercentageControl?.disable();\r\n              } else if (!value && discountPercentageControl?.disabled) {\r\n                  discountPercentageControl?.enable();\r\n              }\r\n          } catch (error) {\r\n              console.error('Error in discountAmountControl subscription:', error);\r\n          }\r\n      });\r\n\r\n      // If type is PRODUCT then discounted fields are get hidden... so below is code for that condition\r\n      // When the type changes, adjust validators accordingly\r\n      const typeControl = this.promotionForm.get('type');\r\n\r\n      typeControl?.valueChanges.subscribe((type: string) => {\r\n        // Dynamically adjust validators based on the selected type\r\n        if (type === 'PRODUCT') {\r\n          discountPercentageControl?.clearValidators();\r\n          discountAmountControl?.clearValidators();\r\n        } else {\r\n          discountPercentageControl?.setValidators([Validators.min(0), Validators.max(100)]);\r\n          discountAmountControl?.setValidators(null);\r\n        }\r\n\r\n        // Update and validate the controls\r\n        discountPercentageControl?.updateValueAndValidity();\r\n        discountAmountControl?.updateValueAndValidity();\r\n\r\n        // Update the form level validators as well\r\n        this.promotionForm.updateValueAndValidity();\r\n      });\r\n      \r\n      // If type is FLAT then buy and get qty are get hidden... so below is code for that condition\r\n      // When the type changes, adjust validators accordingly\r\n      const buyQtyControl = this.promotionForm.get('buyQuantity');\r\n      const getQtyControl = this.promotionForm.get('getQuantity');\r\n      typeControl?.valueChanges.subscribe((type: string) => {\r\n        // Dynamically adjust validators based on the selected type\r\n        if (type === 'FLAT') {\r\n          buyQtyControl?.clearValidators();\r\n          getQtyControl?.clearValidators();\r\n        } else {\r\n          getQtyControl?.setValidators(Validators.required);\r\n          buyQtyControl?.setValidators(Validators.required);\r\n        }\r\n\r\n        // Update and validate the controls\r\n        getQtyControl?.updateValueAndValidity();\r\n        buyQtyControl?.updateValueAndValidity();\r\n\r\n        // Update the form level validators as well\r\n        this.promotionForm.updateValueAndValidity();\r\n      });\r\n\r\n    } catch (error) {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: error\r\n        })\r\n    }\r\n  }\r\n\r\n  get f() {\r\n    return this.promotionForm.controls;\r\n  }\r\n  \r\n  atLeastOneValidator: ValidatorFn = (control: AbstractControl): ValidationErrors | null => {\r\n    const discountPercentage = control.get('discountPercentage').value;\r\n    const discountAmount = control.get('discountAmount').value;\r\n  \r\n    // Check if the type is \"DISCOUNT\" and at least one of the fields is empty\r\n    if (control.get('type').value === 'DISCOUNT' && (!discountPercentage && !discountAmount)) {\r\n      return { atLeastOneError: true };\r\n    }\r\n  \r\n    return null;\r\n  };  \r\n\r\n  getPromotionById() {\r\n    this.promotionService.getPromotionById({}, this.promotionId).then((res) => {\r\n      if(res.success) {\r\n        this.promotionList = res.data;\r\n        this.promotionForm.patchValue({\r\n          schemaName: res.data.schemaName,\r\n          buyQuantity: res.data.buyQuantity,\r\n          getQuantity: res.data.getQuantity,\r\n          discountPercentage: res.data?.discountPercentage,\r\n          discountAmount: res.data?.discountAmount,\r\n          type: res.data.type,\r\n          minBillAmt: res.data.minumumBill,\r\n        })\r\n        // If you have product data, then fetching the whole product data into the array list\r\n        this.productsIdList = res.data.products;\r\n        this.freeProductData = res.data.freeProduct;\r\n\r\n        // Add product Id into the selectedProductIds array for each product\r\n        for (const product of this.productsIdList) {\r\n          this.selectedProductIds.push(product.id)\r\n        }\r\n        \r\n      }\r\n      },(err) => {\r\n        if (err.error.status === 404) {\r\n            this.toastService.toastMsg({\r\n              title: 'Error',\r\n              content: \"Data Not Found!!!\"\r\n            })\r\n        } else {\r\n          this.toastService.toastMsg({\r\n            title: 'Error',\r\n            content: this.titleCasePipe.transform(err.error.error_message)\r\n          })\r\n        }\r\n      });\r\n  }\r\n\r\n  numberOnly(event): boolean {\r\n    const charCode = (event.which) ? event.which : event.keyCode;\r\n    if (charCode > 31 && (charCode < 48 || charCode > 57)) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  onSave() {\r\n    this.submitted = true; \r\n    const payload = {\r\n      promotionId: this.promotionId,\r\n      promotionData: {\r\n        type: this.promotionForm.value.type ? this.promotionForm.value.type : null,\r\n        // isActive: true,\r\n        schemaName: this.promotionForm.value.schemaName ? this.promotionForm.value.schemaName : null,\r\n        buyQuantity: this.promotionForm.value.type !== 'FLAT' ? parseInt(this.promotionForm.value.buyQuantity, 10) : null,\r\n        getQuantity: this.promotionForm.value.type !== 'FLAT' ? parseInt(this.promotionForm.value.getQuantity, 10) : null,\r\n        discountPercentage: this.promotionForm.value.discountPercentage ? this.promotionForm.value.discountPercentage : null,\r\n        discountAmount: this.promotionForm.value.discountAmount ? this.promotionForm.value.discountAmount : null,\r\n        minumumBill: this.promotionForm.value.minBillAmt ? this.promotionForm.value.minBillAmt : null,\r\n      },    \r\n      productArray: this.selectedProductIds.map(productId => ({ 'productId': productId }))\r\n    };\r\n    console.log(\"promotionData\",payload,this.promotionForm.value.type)\r\n    if (this.promotionForm.value.type === 'PRODUCT') {\r\n      // Check if the type is 'PRODUCT' and update the promotion\r\n      this.promotionService.updatePromotion({ data: payload, userId: this.currentUser.id })\r\n        .then((res) => {\r\n          if (res.success) {\r\n            this.commonService.notifyDataAdded();\r\n            this.toastService.toastMsg({\r\n              title: 'Success',\r\n              content: \"Promotion Updated Successfully!!!\"\r\n            });\r\n            this.dialogRef.close();\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          this.toastService.toastMsg({\r\n            title: 'Error',\r\n            content: this.titleCasePipe.transform(error.error.error_message)\r\n          });\r\n        });\r\n    } else if (this.selectedProductIds.length > 0) {\r\n      // For other types, check if selected products exist, then update the promotion\r\n      this.promotionService.updatePromotion({ data: payload, userId: this.currentUser.id })\r\n        .then((res) => {\r\n          if (res.success) {\r\n            this.commonService.notifyDataAdded();\r\n            this.toastService.toastMsg({\r\n              title: 'Success',\r\n              content: \"Promotion Updated Successfully!!!\"\r\n            });\r\n            this.dialogRef.close();\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          this.toastService.toastMsg({\r\n            title: 'Error',\r\n            content: this.titleCasePipe.transform(error.error.error_message)\r\n          });\r\n        });\r\n    } else {\r\n      // If neither condition is met, show an error message\r\n      this.toastService.toastMsg({\r\n        title: 'Error',\r\n        content: 'Please select at least one product'\r\n      });\r\n    }\r\n   \r\n  }\r\n\r\n  cancel() {\r\n    this.dialogRef.close();\r\n  }\r\n\r\n}\r\n","<div *ngIf=\"isLoading\" class=\"loader-container\">\r\n    <div class=\"loader\">\r\n        <div class=\"spinner-border\" role=\"status\">\r\n            <span class=\"visually-hidden\">Loading...</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class=\"container-fluid bg-white p-0\">\r\n    <div class=\"row headerButtons mb-3\" id=\"showoptionHide\">\r\n        <div class=\"flex-item searchBar\">\r\n            <input type=\"search\" id=\"searchInput\" class=\"search-form-control pe-5 my-2\" placeholder=\"Search...\"\r\n                (input)=\"onSearchInputChange($event.target.value)\" />\r\n        </div>\r\n        <div class=\"navOption-btns flex-item formButtons mx-0\">\r\n            <button id=\"saleButtonPrint1\" class=\"btn text-nowrap my-2\" type=\"button\" (click)=\"addPromotionModal()\">\r\n                <i class=\"fas fa-plus me-2\"> </i>Add Promotion&nbsp;&nbsp;&nbsp;\r\n            </button>\r\n            <button id=\"saleButtonPrint1\" class=\"btn text-nowrap my-2\" type=\"button\" (click)=\"counterDiscountModal()\">\r\n                <i class=\"fas fa-plus me-2\"> </i>Counter Discount&nbsp;&nbsp;&nbsp;\r\n            </button>\r\n\r\n            <!-- <button id=\"saleButtonPrint1\" class=\"btn text-nowrap my-2\" type=\"button\"\r\n                onclick=\"location.href = '';\">\r\n                <i class=\"fas fa-download\"></i>\r\n            </button> -->\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"table-container overflow-auto\">\r\n        <div class=\"table-div\" style=\"overflow-x: auto\">\r\n            <table class=\"table table-responsive\">\r\n                <thead>\r\n                    <tr>\r\n                      <th class=\"text-nowrap\" style=\"vertical-align: middle;width:80px;height:50px;display:flex;align-items: center;\">\r\n\r\n                            <input type=\"checkbox\" class=\"form-check-input\" (change)=\"onChekMultiple($event)\"\r\n                                [value]=\"-1\" [checked]=\"\r\n                                promotionIdList.length === promotionList.length\r\n                              \" [(ngModel)]=\"allSelect\" />\r\n                            <div class=\"d-flex align-items-center\">\r\n                                <span *ngIf=\"showDeleteButton\">\r\n                                    <button *ngIf=\"checkSingleArray.length > 0 || isChecked\" class=\"btn\"\r\n                                        data-bs-toggle=\"modal\" data-bs-target=\"#errorArchiveSelect-modal\"\r\n                                        style=\"padding-top: 15px\">\r\n                                        <span *ngIf=\"checkSingleArray.length > 0 || isChecked\"\r\n                                            class=\"material-icons icon-color iconFontSize\" data-bs-toggle=\"tooltip\"\r\n                                            style=\"color: #fc7643\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"\r\n                                            title=\"Archive\" (click)=\"\r\n                                            upiCheckedId.length > 0\r\n                                              ? getUPIcheckId(upiCheckedId)\r\n                                              : getSingleCheckedId(checkSingleArray)\r\n                                          \">archive\r\n                                        </span>\r\n                                    </button>\r\n                                </span>\r\n                                <span *ngIf=\"showUnarchiveButton\">\r\n                                    <button *ngIf=\"checkSingleArray.length > 0 || isChecked\" class=\"btn\"\r\n                                        data-bs-toggle=\"modal\" data-bs-target=\"#errorUnarchiveSelect-modal\"\r\n                                        style=\"padding-top: 15px\">\r\n                                        <span *ngIf=\"checkSingleArray.length > 0 || isChecked\"\r\n                                            class=\"material-icons icon-color iconFontSize\" data-bs-toggle=\"tooltip\"\r\n                                            style=\"color: #fc7643\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\"\r\n                                            title=\"Unarchive\" (click)=\"\r\n                                            upiCheckedId.length > 0\r\n                                              ? getUPIcheckId(upiCheckedId)\r\n                                              : getSingleCheckedId(checkSingleArray)\r\n                                          \">unarchive\r\n                                        </span>\r\n                                    </button>\r\n                                </span>\r\n                            </div>\r\n                      </th>\r\n                      <th class=\"text-nowrap\">Schema Name</th>\r\n                      <th class=\"text-nowrap\">Schema Type\r\n                          <div class=\"dropdown\" #dropdown>\r\n                          <img src=\"../../../../assets/icons/filter-filled-tool-symbol.png\" width=\"17\"\r\n                              height=\"17\" alt=\"filter\" class=\"filterIcon\" (click)=\"toggleFilter()\">\r\n                          <div class=\"filterBox\" [ngClass]=\"{'show': isFilterVisible}\">\r\n                              <div class=\"filterOptions\">\r\n                              <label>\r\n                                  <input type=\"radio\" name=\"filter\" (change)=\"updateTypeFilter('ALL')\" checked> All\r\n                              </label>\r\n                              <label>\r\n                                  <input type=\"radio\" name=\"filter\" (change)=\"updateTypeFilter('DISCOUNT')\"> DISCOUNT\r\n                              </label>\r\n                              <label>\r\n                                  <input type=\"radio\" name=\"filter\" (change)=\"updateTypeFilter('PRODUCT')\"> PRODUCT\r\n                              </label>\r\n                              <label>\r\n                                  <input type=\"radio\" name=\"filter\" (change)=\"updateTypeFilter('FLAT')\"> FLAT\r\n                              </label>\r\n                              </div>\r\n                          </div>\r\n                          </div>\r\n                      </th>\r\n                      <th class=\"text-nowrap\">Get Qyt</th>\r\n                      <th class=\"text-nowrap\">Buy Qyt</th>\r\n                      <th class=\"text-nowrap\">Discount</th>\r\n                      <th class=\"text-nowrap\">Minimun Amt</th>\r\n                      <th class=\"text-nowrap\"></th>\r\n                      <th class=\"text-nowrap\"></th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <ng-container *ngFor=\"let item of promotionList; let i = index\">\r\n                        <tr style=\"color: #676398 !important\"\r\n                            [ngStyle]=\"{ 'background-color': item.isDeleted ? '#c7c2de' : i % 2 === 0 ? '#ffffff' : '#f2f2f2' }\"\r\n                            *ngIf=\"selectedTypeFilter === null || item.type === selectedTypeFilter\">\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle;width:80px;\">\r\n                                <input class=\"form-check-input\" type=\"checkbox\" [ngClass]=\"{\r\n                                    'custom-checkbox': !item.isDeleted,\r\n                                    'custom-checkbox deleted': item.isDeleted\r\n                                    }\" [checked]=\"promotionIdList.includes(item.id)\" (change)=\"onChekedsingleCheck($event, item.id)\"\r\n                                    [value]=\"item.id\" />\r\n                            </td>\r\n                            <td class=\"long-name\" style=\"vertical-align: middle\">\r\n                                {{ item?.schemaName }}\r\n                            </td><td class=\"long-name\" style=\"vertical-align: middle\">\r\n                                {{ item?.type }}\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle\">\r\n                                {{ item?.buyQuantity }}\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle\">\r\n                                {{ item?.getQuantity }}\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle\">\r\n                                {{ item?.discountPercentage ? item?.discountPercentage + ' %' : ('&nbsp;' + (item?.discountAmount != null ? (item?.discountAmount | number:'1.2-2') : '0.00')) }}\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"vertical-align: middle\">\r\n                                {{ item?.minumumBill }}\r\n                            </td>\r\n                            <td class=\"text-nowrap varticalAlign\">\r\n                                <div class=\"\">\r\n                                    <button class=\"toggle-button\" (click)=\"isActive(item.id, item.isActive)\"\r\n                                        [ngClass]=\"{'active': item.isActive, 'inactive': !item.isActive}\" [disabled]=\"item.isDefault\">\r\n                                        <div class=\"toggle-slider\"></div>\r\n                                    </button>\r\n                                </div>\r\n                            </td>\r\n                            <td class=\"text-nowrap\" style=\"text-align: center; vertical-align: middle\">\r\n                                <div>\r\n                                    <!-- <button class=\"btn\">\r\n                                        <span class=\"bi bi-eye icon-color iconFontSize ps-2\" (click)=\"viewConsignmentModal(item.id)\" data-bs-toggle=\"tooltip\"\r\n                                        data-bs-placement=\"top\" title=\"View\"></span>\r\n                                    </button> -->\r\n\r\n                                    <button class=\"btn\">\r\n                                        <div class=\"\" (click)=\"assignProduct(item.id)\" data-bs-toggle=\"tooltip\" data-bs-placement=\"top\" title=\"Assign Product\">\r\n                                            <img src=\"/assets/icons/dashboard-icons/assign_products.png\" class=\"bi-pie-chart\" width=\"20\" height=\"20\">\r\n                                        </div>\r\n                                    </button>\r\n\r\n                                    <button class=\"btn\">\r\n                                        <span class=\"bi-pencil-square icon-color iconFontSize ps-2\"\r\n                                            (click)=\"editPromotionModal(item.id)\" data-bs-toggle=\"tooltip\"\r\n                                            data-bs-placement=\"top\" title=\"Edit\"></span>\r\n                                    </button>\r\n\r\n                                    <button class=\"btn mt-2\" data-bs-toggle=\"modal\" data-bs-target=\"#errorDelete-modal\" [disabled]=\"this.promotionIdList.length != 0\">\r\n                                        <span class=\"material-icons icon-color iconFontSize\" data-bs-toggle=\"tooltip\"\r\n                                            style=\"color: #fc7643\" (click)=\"archhivePromotion(item.id, item.isDeleted)\"\r\n                                            data-bs-placement=\"top\" [title]=\"item.isDeleted ? 'Unarchive' : 'Archive'\">{{\r\n                                            item.isDeleted ? \"unarchive\" : \"archive\" }}</span>\r\n                                    </button>\r\n                                </div>\r\n                            </td>\r\n                            <!-- <td class=\"text-nowrap\" style=\"text-align: center; vertical-align: middle\"></td> -->\r\n\r\n                        </tr>\r\n                    </ng-container>\r\n                </tbody>\r\n                <tbody *ngIf=\"promotionList && promotionList.length === 0\">\r\n                    <tr class=\"text-center\">\r\n                      <td style = \"width:80px;\">&nbsp;</td>\r\n                        <td colspan=\"8\">\r\n                            <img class=\"image-responsive\"\r\n                                src=\"../../../assets/img/icons/spot-illustrations/notfound1.png\" alt=\"notfound1\"\r\n                                width=\"200\" height=\"150\" />\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n            <!-- <mat-paginator sticky class=\"float-right mt-2\" *ngIf=\"promotionList.length > 0\"\r\n                [pageSize]=\"partyPageSize\" [pageSizeOptions]=\"[5, 10, 20, 30]\" [length]=\"totalrow\"\r\n                [pageIndex]=\"currentPageNo\" showFirstLastButtons (page)=\"handlePage($event)\" aria-label=\"Select page\">\r\n            </mat-paginator> -->\r\n        </div>\r\n\r\n        <!-- ultiple Unarchive -->\r\n        <div class=\"modal fade\" id=\"errorUnarchiveSelect-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\" role=\"document\" style=\"max-width: 350px\">\r\n                <div class=\"modal-content position-relative\">\r\n                    <div class=\"position-absolute top-0 end-0 mt-2 me-2 z-index-1\">\r\n                        <a class=\"btn-close btn btn-sm btn-circle d-flex flex-center transition-base\"\r\n                            data-bs-dismiss=\"modal\" aria-label=\"Close\"></a>\r\n                    </div>\r\n                    <div class=\"modal-body p-0\">\r\n                        <div class=\"rounded-top-lg py-3 ps-4 pe-6 bg-light\">\r\n                            <h2 class=\"mb-1 text-center font-weight-bold\" style=\"font-weight: 800\"\r\n                                id=\"modalExampleDemoLabel\">\r\n                                <i class=\"fa fa-unlock-alt\" aria-hidden=\"true\"></i> Unarchive\r\n                                Promotions?\r\n                            </h2>\r\n                        </div>\r\n                        <h4 *ngIf=\"isChecked\" class=\"text-center\">\r\n                            Are you sure to unarchive all Promotions?\r\n                        </h4>\r\n                        <h4 *ngIf=\"!isChecked\" class=\"text-center\">\r\n                            Are you sure to unarchive all selected Promotions?\r\n                        </h4>\r\n                    </div>\r\n                    <div class=\"modal-footer justify-content-center\">\r\n                        <a class=\"btn btn-outline-success\" data-bs-dismiss=\"modal\">Close</a>\r\n                        <a *ngIf=\"isChecked\" class=\"btn btn-outline-danger\" data-bs-dismiss=\"modal\"\r\n                            (click)=\"unArchiveMultiplePromotion()\">Unarchive</a>\r\n                        <a *ngIf=\"!isChecked\" class=\"btn btn-outline-danger\" data-bs-dismiss=\"modal\"\r\n                            (click)=\"unArchiveMultiplePromotion()\">Unarchive</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- ultiple Archive -->\r\n        <div class=\"modal fade\" id=\"errorArchiveSelect-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\" role=\"document\" style=\"max-width: 350px\">\r\n                <div class=\"modal-content position-relative\">\r\n                    <div class=\"position-absolute top-0 end-0 mt-2 me-2 z-index-1\">\r\n                        <a class=\"btn-close btn btn-sm btn-circle d-flex flex-center transition-base\"\r\n                            data-bs-dismiss=\"modal\" aria-label=\"Close\"></a>\r\n                    </div>\r\n                    <div class=\"modal-body p-0\">\r\n                        <div class=\"rounded-top-lg py-3 ps-4 pe-6 bg-light\">\r\n                            <h2 class=\"mb-1 text-center font-weight-bold\" style=\"font-weight: 800\"\r\n                                id=\"modalExampleDemoLabel\">\r\n                                <i class=\"fa fa-lock-alt\" aria-hidden=\"true\"></i> Archive\r\n                                Promotions?\r\n                            </h2>\r\n                        </div>\r\n                        <h4 *ngIf=\"isChecked\" class=\"text-center\">\r\n                            Are you sure to archive all Promotions?\r\n                        </h4>\r\n                        <h4 *ngIf=\"!isChecked\" class=\"text-center\">\r\n                            Are you sure to archive all selected Promotions?\r\n                        </h4>\r\n                    </div>\r\n                    <div class=\"modal-footer justify-content-center\">\r\n                        <a class=\"btn btn-outline-success\" data-bs-dismiss=\"modal\">Close</a>\r\n                        <a *ngIf=\"isChecked\" class=\"btn btn-outline-danger\" data-bs-dismiss=\"modal\"\r\n                            (click)=\"archiveMultiplePromotion()\">Archive</a>\r\n                        <a *ngIf=\"!isChecked\" class=\"btn btn-outline-danger\" data-bs-dismiss=\"modal\"\r\n                            (click)=\"archiveMultiplePromotion()\">Archive</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Signle archive  -->\r\n        <div class=\"modal fade\" id=\"errorDelete-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\" role=\"document\" style=\"max-width: 350px\">\r\n                <div class=\"modal-content position-relative\">\r\n                    <div class=\"position-absolute top-0 end-0 mt-2 me-2 z-index-1\">\r\n                        <a class=\"btn-close btn btn-sm btn-circle d-flex flex-center transition-base\"\r\n                            data-bs-dismiss=\"modal\" aria-label=\"Close\"></a>\r\n                    </div>\r\n                    <div class=\"modal-body p-0\">\r\n                        <div class=\"rounded-top-lg py-3 ps-4 pe-6 bg-light\">\r\n                            <h2 *ngIf=\"!isdeletedParty\" class=\"mb-1 text-center font-weight-bold\"\r\n                                style=\"font-weight: 800\" id=\"modalExampleDemoLabel\">\r\n                                Archive Promotion?\r\n                            </h2>\r\n                            <h2 *ngIf=\"isdeletedParty\" class=\"mb-1 text-center font-weight-bold\"\r\n                                style=\"font-weight: 800\" id=\"modalExampleDemoLabel\">\r\n                                Unarchive Promotion?\r\n                            </h2>\r\n                        </div>\r\n                        <h4 class=\"text-center\" *ngIf=\"!isdeletedParty\">\r\n                            Are You Sure To Archive Promotions?\r\n                        </h4>\r\n                        <h4 class=\"text-center\" *ngIf=\"isdeletedParty\">\r\n                            Are You Sure To Unarchive Promotions?\r\n                        </h4>\r\n                    </div>\r\n                    <div class=\"modal-footer justify-content-center\">\r\n                        <a class=\"btn btn-outline-success\" data-bs-dismiss=\"modal\">Close</a>\r\n                        <a class=\"btn btn-outline-danger\" *ngIf=\"!isdeletedParty\" (click)=\"archiveSignlePromotion()\"\r\n                            data-bs-dismiss=\"modal\">Archive\r\n                        </a>\r\n                        <a *ngIf=\"isdeletedParty\" class=\"btn btn-outline-warning\" (click)=\"archiveSignlePromotion()\"\r\n                            data-bs-dismiss=\"modal\">Unarchive\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Flat Discount Modal -->\r\n        <div class=\"modal fade\" id=\"flatDiscount-modal\" tabindex=\"-1\" role=\"dialog\" aria-hidden=\"true\">\r\n            <div class=\"modal-dialog modal-dialog-centered\" role=\"document\" style=\"max-width: 350px\">\r\n                <div class=\"modal-content position-relative\">\r\n                    <div class=\"position-absolute top-0 end-0 mt-2 me-2 z-index-1\">\r\n                        <a class=\"btn-close btn btn-sm btn-circle d-flex flex-center transition-base\"\r\n                            data-bs-dismiss=\"modal\" aria-label=\"Close\"></a>\r\n                    </div>\r\n                    <div class=\"modal-body p-0\">\r\n                        <div class=\"rounded-top-lg py-3 ps-4 pe-6 bg-light\">\r\n                            <h2 class=\"mb-1 text-center font-weight-bold\"\r\n                                style=\"font-weight: 800\" id=\"modalExampleDemoLabel\">\r\n                                Flat Discount\r\n                            </h2>\r\n                        </div>\r\n                        <h4 class=\"text-center\">\r\n                        </h4>\r\n                    </div>\r\n                    <div class=\"modal-footer justify-content-center\">\r\n                        <a class=\"btn btn-outline-success\" data-bs-dismiss=\"modal\">Close</a>\r\n                        <a class=\"btn btn-outline-danger\"\r\n                            data-bs-dismiss=\"modal\">Save\r\n                        </a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n","import { TitleCasePipe } from '@angular/common';\r\nimport { Component, ElementRef, HostListener, OnInit, ViewChild } from '@angular/core';\r\nimport { MatDialog, MatDialogRef } from '@angular/material/dialog';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { Subject, Subscription } from 'rxjs';\r\nimport { debounceTime, distinctUntilChanged, tap } from 'rxjs/operators';\r\nimport { CommonService } from 'src/app/core/services/common.service';\r\nimport { PromotionService } from 'src/app/core/services/promotion.service';\r\nimport { ToastNotificationService } from 'src/app/core/services/toast-notification.service';\r\nimport { AddPromotionComponent } from '../add-promotion/add-promotion/add-promotion.component';\r\nimport { AssignProductToPromotionComponent } from '../assign-product-to-promotion/assign-product-to-promotion/assign-product-to-promotion.component';\r\nimport { EditPromotionComponent } from '../edit-promotion/edit-promotion/edit-promotion.component';\r\nimport { CounterDiscModalComponent } from '../counter-disc-modal/counter-disc-modal.component';\r\nimport { CouponModalComponent } from '../coupon-modal/coupon-modal.component';\r\n\r\n@Component({\r\n  selector: 'app-promotion-list',\r\n  templateUrl: './promotion-list.component.html',\r\n  styleUrls: ['./promotion-list.component.scss']\r\n})\r\nexport class PromotionListComponent implements OnInit {\r\n  \r\n  private searchSubject = new Subject<string>();\r\n  private searchSubscription: Subscription;\r\n  public currentUser = JSON.parse(localStorage.getItem(\"currentUser\"))\r\n  promotionList: any[] = [];\r\n  excelFileUpload: any;\r\n  public currentpage: any;\r\n  public totalrow: any;\r\n  public toatlPages: any;\r\n  public currentPageNo: number = 0;\r\n  public partyPageSize: number = 5;\r\n  public pagesize: number = 1;\r\n  public count: number = 0;\r\n  promotionIdList: any[] = [];\r\n  selectedIdList: any[] = [];\r\n\r\n  public archiveIconfalse: boolean = false;\r\n  public checkSingleArray: any = [];\r\n  public isChecked: boolean = false;\r\n  public upiCheckedId = [];\r\n  public upiCheckedId1 = [];\r\n  public allSelect: boolean = false;\r\n  public checkSelect: boolean = false;\r\n\r\n  public checkSelectsingle: boolean = false;\r\n\r\n  public checkSelectsinglefalse: boolean = false;\r\n  public checkSelectsingletrue: boolean = false;\r\n  promotionId: any;\r\n  pageNumberDisplay: any[];\r\n  isLoading: boolean;\r\n  archivedPartyIds: any[];\r\n  unarchivedPartyIds: any[];\r\n  showUnarchiveButton: boolean;\r\n  showDeleteButton: boolean;\r\n  isdeletedParty: boolean;\r\n  selectedTypeFilter: string | null = null;\r\n  isFilterVisible: any;\r\n  @ViewChild('dropdown') dropdown: ElementRef;\r\n\r\n  constructor(public router: Router, public dialog: MatDialog, private commonService: CommonService,\r\n    public route: ActivatedRoute, private promotionService: PromotionService,\r\n    public toastService: ToastNotificationService,\r\n    private titleCasePipe: TitleCasePipe) { }\r\n\r\n  ngOnInit(): void {\r\n    this.getAllPromotion();\r\n    this.commonService.rowAdded$.subscribe(() => {\r\n      // Fetch the updated list of users\r\n      this.getAllPromotion();\r\n    });\r\n\r\n    this.searchSubscription = this.searchSubject\r\n      .pipe(debounceTime(800),\r\n        distinctUntilChanged(),\r\n        tap(() => {\r\n          this.isLoading = true; // Show the loader when the API call is initiated\r\n        })).subscribe(searchKey => {\r\n          // Call the API with the search key\r\n          if (searchKey.length >= 3) {\r\n            this.searchPromotion(searchKey.trim());\r\n          } else if (searchKey === '') {\r\n             this.isLoading = false; // Hide the loader if the search key is less than the threshold\r\n            //this.searchConsignment(searchKey);\r\n            this.getAllPromotion()\r\n          } else {\r\n            this.isLoading = false; // Hide the loader if the search key is less than the threshold\r\n          }\r\n        });\r\n  }\r\n\r\n  @HostListener('document:click', ['$event'])\r\n  onDocumentClick(event: Event): void {\r\n    // Check if the clicked element is outside the dropdown\r\n    if (!this.dropdown.nativeElement.contains(event.target as Node)) {\r\n      this.isFilterVisible = false;\r\n    }\r\n  }\r\n\r\n  getAllPromotion() {\r\n    this.promotionService.getAllPromotion({}, this.currentUser.id).then((res) => {\r\n      if(res.success) {\r\n        this.promotionList = res.data.pageData;\r\n        // this.currentPageNo = res.data.currentPage;\r\n        // this.totalrow = res.data.totalrows;\r\n        // this.toatlPages = res.data.totalPages\r\n      }\r\n    },\r\n    (err) => {\r\n      if (err.error.expose) {\r\n        this.toastService.toastMsg({\r\n          title: \"Error\",\r\n          content: this.titleCasePipe.transform(err.error.error_message),\r\n        });\r\n      }\r\n      else {\r\n        this.toastService.toastMsg({\r\n          title: \"Error\",\r\n          content: \"Something Went Wrong.\",\r\n        });\r\n      }\r\n\r\n    }) \r\n  }\r\n\r\n  archhivePromotion(promotionId: string, isdeleted: boolean) {\r\n    this.promotionId = promotionId;\r\n    this.isdeletedParty = isdeleted;\r\n    this.selectedIdList.push(promotionId);\r\n  }\r\n\r\n  archiveSignlePromotion() {\r\n    if (this.isdeletedParty) {\r\n      this.promotionService.unArchiveMultiplePromotions({data: { unArchivePromotions: this.selectedIdList }, userId: this.currentUser.id}).then((res: any) => {\r\n        if (res.success) {\r\n          this.toastService.toastMsg({\r\n            title: 'Success',\r\n            content: \"Promotion Unarchived Successfully!!!\"\r\n          });\r\n\r\n          this.getAllPromotion();\r\n        }\r\n      })\r\n    }\r\n    else {\r\n      this.promotionService.deleteMultiplePromotions({data: { archivePromotions: this.selectedIdList }, userId: this.currentUser.id}).then((res: any) => {\r\n        if (res.success) {\r\n          this.toastService.toastMsg({\r\n            title: 'Success',\r\n            content: \"Promotion Archived Successfully!!!\"\r\n          });\r\n          this.getAllPromotion();\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  onChekedsingleCheck(e, partyId) {\r\n    if (e.target.checked) {\r\n      this.promotionIdList.push(partyId);\r\n      this.checkSingleArray.push(e.target.value);\r\n    } else {\r\n      const index = this.promotionIdList.indexOf(partyId);\r\n      if (index !== -1) {\r\n        this.promotionIdList.splice(index, 1);\r\n        this.checkSingleArray.splice(index, 1);\r\n      }\r\n    }\r\n\r\n    // Clear the archived and unarchived party IDs\r\n    this.archivedPartyIds = [];\r\n    this.unarchivedPartyIds = [];\r\n\r\n    // Update the archived and unarchived party IDs based on the selected parties\r\n    this.promotionIdList.forEach(partyId => {\r\n      const party = this.promotionList.find(item => item.id === partyId);\r\n      if (party) {\r\n        if (party.isDeleted) {\r\n          this.archivedPartyIds.push(partyId);\r\n        } else {\r\n          this.unarchivedPartyIds.push(partyId);\r\n        }\r\n      }\r\n    })\r\n\r\n    // Check if all the selected parties are archived\r\n    const allArchived = this.promotionIdList.every(partyId => {\r\n      const party = this.promotionList.find(item => item.id === partyId);\r\n      return party && party.isDeleted;\r\n    });\r\n\r\n    // Check if all the selected parties are unarchived\r\n    const allUnarchived = this.promotionIdList.every(partyId => {\r\n      const party = this.promotionList.find(item => item.id === partyId);\r\n      return party && !party.isDeleted;\r\n    });\r\n\r\n    // if (allArchived && allUnarchived) {\r\n    if (this.archivedPartyIds.length > 0 && this.unarchivedPartyIds.length > 0) {\r\n      // Show an alert error message to the user\r\n      alert(\"Please select either archived or unarchived Promotions.\");\r\n      // Uncheck all the selected parties and header checkbox\r\n      this.promotionIdList = [];\r\n      this.checkSingleArray = [];\r\n      this.checkSelectsingle = false;\r\n      this.upiCheckedId = [];\r\n      this.isChecked = false;\r\n      this.allSelect = false;\r\n      this.checkSelect = false;\r\n      this.checkSelectsingle = false;\r\n\r\n      // Uncheck all the checkboxes in the template\r\n      const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\r\n      checkboxes.forEach((checkbox) => {\r\n        const inputElement = checkbox as HTMLInputElement;\r\n        inputElement.checked = false;\r\n      });\r\n\r\n    } else if (allArchived) {\r\n      console.log('Archived');\r\n      // Show unarchive button\r\n      this.showUnarchiveButton = true;\r\n      this.showDeleteButton = false;\r\n    } else if (allUnarchived) {\r\n      console.log('Unarchived');\r\n      // Show archive button\r\n      this.showDeleteButton = true;\r\n      this.showUnarchiveButton = false;\r\n    } else {\r\n      // Show error message or handle the case when there are both archived and unarchived parties selected\r\n      alert(\"Please select either archived or unarchived Promotions.\");\r\n      // Uncheck all the selected parties and header checkbox\r\n      this.promotionIdList = [];\r\n      this.checkSingleArray = [];\r\n      this.checkSelectsingle = false;\r\n      this.upiCheckedId = [];\r\n      this.isChecked = false;\r\n      this.allSelect = false;\r\n      this.checkSelect = false;\r\n      this.checkSelectsingle = false;\r\n      this.showDeleteButton = false;\r\n      this.showUnarchiveButton = false;\r\n\r\n      // Uncheck all the checkboxes in the template\r\n      const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\r\n      checkboxes.forEach((checkbox) => {\r\n        const inputElement = checkbox as HTMLInputElement;\r\n        inputElement.checked = false;\r\n      });\r\n    }\r\n\r\n  }\r\n\r\n  getSingleCheckedId(promotionId) {\r\n    this.promotionId = promotionId;\r\n  }\r\n\r\n  onChekMultiple($event) {\r\n    const isChecked = $event.target.checked;\r\n    if (isChecked) {\r\n      this.promotionIdList = this.promotionList.map(item => item.id);\r\n    } else {\r\n      this.promotionIdList = [];\r\n      this.showDeleteButton = false;\r\n      this.showUnarchiveButton = false\r\n    }\r\n    this.checkSelect = isChecked; // Update the checkbox state in the header\r\n\r\n    let id = $event.target.value;\r\n    this.isChecked = $event.target.checked;\r\n    this.upiCheckedId = this.promotionList.map((item) => {\r\n      if (id === -1) {\r\n        if (this.isChecked == true) {\r\n          this.checkSelectsingle = true;\r\n          return item.id;\r\n        }\r\n        else {\r\n          this.checkSelectsingle = false;\r\n          this.upiCheckedId = [];\r\n        }\r\n      }\r\n    })\r\n    // Clear the archived and unarchived party IDs\r\n    this.archivedPartyIds = [];\r\n    this.unarchivedPartyIds = [];\r\n\r\n    // Update the archived and unarchived party IDs based on the selected parties\r\n    this.promotionIdList.forEach(partyId => {\r\n      const party = this.promotionList.find(item => item.id === partyId);\r\n      if (party) {\r\n        if (party.isDeleted) {\r\n          this.archivedPartyIds.push(partyId);\r\n        } else {\r\n          this.unarchivedPartyIds.push(partyId);\r\n        }\r\n      }\r\n\r\n      // Check if all the selected parties are archived\r\n      const allArchived = this.promotionIdList.every(partyId => {\r\n        const party = this.promotionList.find(item => item.id === partyId);\r\n        return party && party.isDeleted;\r\n      });\r\n      // Check if all the selected parties are unarchived\r\n      const allUnarchived = this.promotionIdList.every(partyId => {\r\n        const party = this.promotionList.find(item => item.id === partyId);\r\n        return party && !party.isDeleted;\r\n      });\r\n\r\n      if (allArchived) {\r\n        // Show unarchive button\r\n        this.showUnarchiveButton = true\r\n        this.showDeleteButton = false;\r\n      } else if (allUnarchived) {\r\n        // Show archive button\r\n        this.showDeleteButton = true;\r\n        this.showUnarchiveButton = false\r\n      } else {\r\n        // Show error message or handle the case when there are both archived and unarchived parties selected\r\n      }\r\n    });\r\n\r\n    if (this.archivedPartyIds.length > 0 && this.unarchivedPartyIds.length > 0) {\r\n      alert(\"Please select either archived or unarchived Promotions\");\r\n      // Uncheck all the selected parties and header checkbox\r\n      this.promotionIdList = [];\r\n      this.checkSingleArray = [];\r\n      this.checkSelectsingle = false;\r\n      this.upiCheckedId = [];\r\n      this.isChecked = false;\r\n      this.allSelect = false;\r\n      this.checkSelect = false;\r\n      this.checkSelectsingle = false;\r\n\r\n      // Uncheck all the checkboxes in the template\r\n      const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\r\n      checkboxes.forEach((checkbox) => {\r\n        const inputElement = checkbox as HTMLInputElement;\r\n        inputElement.checked = false;\r\n      });\r\n\r\n      // Throw an error to prevent further processing\r\n      this.toastService.toastMsg({\r\n        title: 'Warning',\r\n        content: 'Please select either archived or unarchived Promotions'\r\n      })\r\n      throw new Error(\"Please select either archived or unarchived Promotions\");\r\n    }\r\n  }\r\n\r\n  getUPIcheckId(promotionId) {\r\n    this.promotionId = promotionId;\r\n  }\r\n\r\n  archiveMultiplePromotion() {\r\n    if (this.currentPageNo === 1) {\r\n      this.currentPageNo = this.currentPageNo;\r\n    }\r\n    else {\r\n      if (this.toatlPages > this.currentPageNo) {\r\n        this.currentPageNo = this.currentPageNo - 1;\r\n      }\r\n    }\r\n    const requestBody = {\r\n      archivePromotions: this.promotionIdList\r\n    };\r\n\r\n    this.promotionService.deleteMultiplePromotions({ data: requestBody, userId: this.currentUser.id }).then((result: any) => {\r\n      if (result.success) {\r\n        this.getAllPromotion();\r\n        this.toastService.toastMsg({\r\n          title: 'Success',\r\n          content: \"Promotion Archived Successfully!!!\"\r\n        });\r\n\r\n        this.showDeleteButton = false;\r\n        this.showUnarchiveButton = false\r\n        this.promotionIdList = []; // Clear the selected party IDs after deletion\r\n        this.checkSelect = false // Reset the checkbox state in the header\r\n      }\r\n    }, (err) => {\r\n      if (err.error.expose) {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: this.titleCasePipe.transform(err.error.error_message)\r\n        });\r\n      } else {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: \"Something Went Wrong.\"\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  showDeleteButtonFunc(): boolean {\r\n    return this.unarchivedPartyIds.length > 0;\r\n  }\r\n\r\n  unArchiveMultiplePromotion() {\r\n    const requestBody = {\r\n      unArchivePromotions: this.promotionIdList\r\n    };\r\n    this.promotionService.unArchiveMultiplePromotions({data: requestBody, userId: this.currentUser.id}).then((result: any) => {\r\n      if (result.success) {\r\n        this.getAllPromotion();\r\n        this.toastService.toastMsg({\r\n          title: 'Success',\r\n          content: \"Promotion Unarchived Successfully!!!\"\r\n        });\r\n        this.showDeleteButton = false;\r\n        this.showUnarchiveButton = false\r\n        this.promotionIdList = []; // Clear the selected party IDs after unarchiving\r\n        this.checkSelect = false; // Reset the checkbox state in the header\r\n      }\r\n    }, (err) => {\r\n      if (err.error.expose) {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: this.titleCasePipe.transform(err.error.error_message)\r\n        });\r\n      } else {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: \"Something Went Wrong.\"\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  searchPromotion(searchKey: string) {\r\n    setTimeout(() => {\r\n      if (searchKey.trim() === '') {\r\n        this.getAllPromotion();\r\n        this.isLoading = false; \r\n      } else {\r\n        this.isLoading = false; \r\n        this.promotionList = this.promotionList.filter(item => {\r\n          return (\r\n            (item.schemaName && item.schemaName.toLowerCase().includes(searchKey.toLowerCase())) \r\n          );\r\n        });\r\n        if(this.promotionList.length === 0){\r\n          this.isLoading = false; \r\n          this.toastService.toastMsg({\r\n            title: \"Error\",\r\n            content: searchKey + \" Is Not Found\",\r\n          });\r\n        }\r\n      }\r\n    this.isLoading = false; // Hide the loader after the API call is completed\r\n    }, 500);\r\n  }\r\n\r\n\r\n  onSearchInputChange(searchKey: string) {\r\n    console.log(searchKey);\r\n    // Emit the search key to the searchSubject\r\n    this.searchSubject.next(searchKey.trim());\r\n  }\r\n\r\n  handleInputChange(e) {\r\n    this.excelFileUpload = e.target.files[0];\r\n    const pattern = /\\.(xlsx|xls)$/i; // Pattern to match \".xlsx\" or \".xls\" extension\r\n    if (!pattern.test(this.excelFileUpload.name)) {\r\n      this.toastService.toastMsg({\r\n        title: \"Error\",\r\n        content: \"Invalid Format. Please Select An Excel File.\",\r\n      });\r\n      return;\r\n    }\r\n    if (this.excelFileUpload) {\r\n      let formdata = new FormData();\r\n      formdata.set(\"file\", this.excelFileUpload)\r\n      // this.truckOwnerService.postBulkowner(formdata, this.currentUser.id).then((res) => {\r\n      //   this.toastService.toastMsg({\r\n      //     title: \"Success\",\r\n      //     content: \"Excel Uploaded Successfully\",\r\n      //   });\r\n      //   this.getAllPromotion();\r\n      // }, (err) => {\r\n      //   if (err.error.expose) {\r\n      //     this.toastService.toastMsg({\r\n      //       title: \"Error\",\r\n      //       content: this.titleCasePipe.transform(err.error.error_message),\r\n      //     });\r\n      //   }\r\n      //   else if (err.error.status == \"409\" && err.error.expose == false) {\r\n      //     this.toastService.toastMsg({\r\n      //       title: \"Error\",\r\n      //       content: \"List Of Consignments Already Exists\",\r\n      //     });\r\n      //   }\r\n      //   else {\r\n      //     this.toastService.toastMsg({\r\n      //       title: \"Error\",\r\n      //       content: \"Something Went Wrong.\",\r\n      //     });\r\n      //   }\r\n      // });\r\n    }\r\n  }\r\n\r\n  startUpload() {\r\n    var uploadInput = document.getElementById('uploadFile');\r\n    if (uploadInput) {\r\n      var event = new MouseEvent('click', {\r\n        view: window,\r\n        bubbles: false,\r\n        cancelable: true\r\n      });\r\n      uploadInput.dispatchEvent(event);\r\n    } else {\r\n      this.toastService.toastMsg({\r\n        title: 'Error',\r\n        content: \"Upload element not found\"\r\n      });\r\n    }\r\n  }\r\n\r\n  public handlePage(e: any) {\r\n    this.currentPageNo = e.pageIndex;\r\n    this.pagesize = e.pageSize;\r\n\r\n    if (this.promotionList.length > 0) {\r\n      // if (this.searchKey !== '') {\r\n      //   this.partyPageSize = e.pageSize;\r\n      //   this.searchConsignment(this.searchKey);\r\n      // } else {\r\n        this.partyPageSize = e.pageSize;\r\n        this.getAllPromotion();\r\n      // }\r\n    }\r\n  }\r\n\r\n  addPromotionModal(): void {\r\n    const dialogRef: MatDialogRef<AddPromotionComponent> = this.dialog.open(AddPromotionComponent, {\r\n      width: '700px',\r\n      height: \"100vh\",\r\n      data: {},\r\n      disableClose: true,\r\n      position: {\r\n        right: '0',\r\n      },\r\n    });\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      console.log(`Dialog result: ${result}`);\r\n    });\r\n  }\r\n  \r\n  counterDiscountModal(): void {\r\n    const dialogRef: MatDialogRef<CounterDiscModalComponent> = this.dialog.open(CounterDiscModalComponent, {\r\n      width: '730px',\r\n      height: \"100vh\",\r\n      data: {},\r\n      disableClose: true,\r\n      position: {\r\n        right: '0',\r\n      },\r\n    });\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      console.log(`Dialog result: ${result}`);\r\n    });\r\n  }\r\n  \r\n  // couponsModal(): void {\r\n  //   const dialogRef: MatDialogRef<CouponModalComponent> = this.dialog.open(CouponModalComponent, {\r\n  //     width: 'auto',\r\n  //     height: \"auto\",\r\n  //     data: {},\r\n  //     disableClose: true,\r\n  //     // position: {\r\n  //     //   right: '0',\r\n  //     // },\r\n  //   });\r\n  //   dialogRef.afterClosed().subscribe((result) => {\r\n  //     console.log(`Dialog result: ${result}`);\r\n  //   });\r\n  // }\r\n\r\n  assignProduct(promotionId): void {\r\n    const dialogRef: MatDialogRef<AssignProductToPromotionComponent> = this.dialog.open(AssignProductToPromotionComponent, {\r\n      width: 'auto',\r\n      height: \"auto\",\r\n      data: { promotionId: promotionId},\r\n      disableClose: true,\r\n    });\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      console.log(`Dialog result: ${result}`);\r\n    });\r\n  }\r\n\r\n  editPromotionModal(promotionId) {\r\n    const dialogRef: MatDialogRef<EditPromotionComponent> = this.dialog.open(EditPromotionComponent, {\r\n      width: '700px',\r\n      height: '100vh',\r\n      data: { promotionId: promotionId },\r\n      disableClose: true,\r\n      position: {\r\n        right: '0',\r\n      },\r\n    });\r\n\r\n    dialogRef.afterClosed().subscribe((result) => {\r\n      console.log(`Dialog result: ${result}`);\r\n    });\r\n  }\r\n\r\n  isActive(promotionId, isActive) {\r\n    const newStatus = !isActive; // Toggle between '1' and '0'\r\n    const payload = {\r\n      promotionId: promotionId,        \r\n    };\r\n    this.promotionService.promotionToggle({ data: payload, userId: this.currentUser.id })\r\n      .then((res) => {\r\n        if (res.success) {\r\n              if (newStatus) {\r\n                this.toastService.toastMsg({\r\n                  title: \"Success\",\r\n                  content: \"Status Has Changed To Active\",\r\n                });\r\n                this.getAllPromotion()\r\n              } else {\r\n                this.toastService.toastMsg({\r\n                  title: \"Success\",\r\n                  content: \"Status Has Changed To Inactive\",\r\n                });\r\n                this.getAllPromotion()\r\n              }\r\n            }\r\n      })\r\n      .catch((error) => {\r\n        this.toastService.toastMsg({\r\n          title: 'Error',\r\n          content: this.titleCasePipe.transform(error.error.error_message)\r\n        })\r\n      });\r\n  }\r\n\r\n  // Add a method to update the filter value\r\n  updateTypeFilter(filterValue: string | null) {\r\n    if(filterValue === 'ALL') {\r\n      this.selectedTypeFilter = null;\r\n    } else {\r\n      this.selectedTypeFilter = filterValue;\r\n    }\r\n  }\r\n\r\n  toggleFilter() {\r\n    this.isFilterVisible = !this.isFilterVisible;\r\n  }\r\n\r\n  closeDropdown() {\r\n    this.isFilterVisible = false;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { PromotionsComponent } from './promotions.component';\r\nimport { PromotionListComponent } from './components/promotion-list/promotion-list.component';\r\nimport { CouponModalComponent } from './components/coupon-modal/coupon-modal.component';\r\nimport { CouponComponent } from './components/coupon/coupon.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path:'',\r\n    component: PromotionsComponent,\r\n    children: [\r\n      {\r\n        path:'',\r\n        redirectTo: 'prmotion-list',\r\n        pathMatch: 'full'\r\n      },\r\n      {\r\n        path:'prmotion-list',\r\n        component: PromotionListComponent,\r\n      },\r\n      {\r\n        path:'Coupon-list',\r\n        component: CouponComponent,\r\n      },  \r\n    ],\r\n    pathMatch: 'prefix',\r\n    data: {\r\n      routerLinkActiveOptions: { exact: true, pathMatch: 'full' }\r\n    }\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class PromotionsRoutingModule { }\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-promotions',\r\n  templateUrl: './promotions.component.html',\r\n  styleUrls: ['./promotions.component.scss']\r\n})\r\nexport class PromotionsComponent implements OnInit {\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<div class=\"component-container container-fluid bg-white p-4\">\r\n    <div id=\"navPanel\" class=\"row\">\r\n      <div class=\"navOptions col-xxl-6 col-xl-6 col-lg-12 col-md-12 col-sm-12\">\r\n        <div class=\"row page-nav-link mt-3\">\r\n          <div class=\"col-xxl-1 col-xl-1 col-lg-2 col-md-3 col-sm-6 links\">\r\n            <a class=\"mt-3 pb-1 ps-1 text-nowrap\" routerLink=\"./prmotion-list\" routerLinkActive=\"active\">Promotions</a>\r\n          </div><div class=\"col-xxl-1 col-xl-1 col-lg-2 col-md-3 col-sm-6 links\">\r\n            <a class=\"mt-3 pb-1 ps-1 text-nowrap\" routerLink=\"./Coupon-list\" routerLinkActive=\"active\">Coupons</a>\r\n          </div>\r\n          <div class=\"col-lg-6 \"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <hr class=\"mt-1\">\r\n    <div>\r\n      <router-outlet></router-outlet>\r\n    </div>\r\n  </div>","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { PromotionsRoutingModule } from './promotions-routing.module';\r\nimport { RouterModule } from '@angular/router';\r\nimport { MaterialExampleModule } from 'src/app/material.module';\r\nimport { MatInputModule } from '@angular/material/input';\r\nimport { MatButtonModule } from '@angular/material/button';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { MatNativeDateModule } from '@angular/material/core';\r\nimport { MatFormFieldModule } from '@angular/material/form-field';\r\nimport { MatDatepickerModule } from '@angular/material/datepicker';\r\nimport { MatMomentDateModule } from '@angular/material-moment-adapter';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { BsDatepickerModule } from 'ngx-bootstrap/datepicker';\r\nimport { PromotionsComponent } from './promotions.component';\r\nimport { PromotionListComponent } from './components/promotion-list/promotion-list.component';\r\nimport { AddPromotionComponent } from './components/add-promotion/add-promotion/add-promotion.component';\r\nimport { EditPromotionComponent } from './components/edit-promotion/edit-promotion/edit-promotion.component';\r\nimport { AssignProductToPromotionComponent } from './components/assign-product-to-promotion/assign-product-to-promotion/assign-product-to-promotion.component';\r\nimport { CounterDiscModalComponent } from './components/counter-disc-modal/counter-disc-modal.component';\r\nimport { CouponModalComponent } from './components/coupon-modal/coupon-modal.component';\r\nimport { CouponComponent } from './components/coupon/coupon.component';\r\nimport { EditCouponComponent } from './components/edit-coupon/edit-coupon.component';\r\n@NgModule({\r\n  declarations: [\r\n    PromotionsComponent,\r\n    PromotionListComponent,\r\n    AddPromotionComponent,\r\n    EditPromotionComponent,\r\n    AssignProductToPromotionComponent,\r\n    CounterDiscModalComponent,\r\n    CouponModalComponent,\r\n    CouponComponent,\r\n    EditCouponComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    PromotionsRoutingModule,\r\n    RouterModule,\r\n    MaterialExampleModule,\r\n    MatInputModule,\r\n    MatButtonModule,\r\n    MatIconModule,\r\n    MatNativeDateModule,\r\n    MatFormFieldModule,\r\n    MatDatepickerModule,\r\n    MatMomentDateModule,    \r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    BsDatepickerModule.forRoot(),\r\n  ]\r\n})\r\nexport class PromotionsModule { }\r\n"]}